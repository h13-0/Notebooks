#计算机网络 #应试笔记与八股

## 目录
```toc
```

## 5.1 传输层提供的服务

### 5.1.1 传输层的功能

在OSI七层模型中，传输层位于表示层和传输层之间。对于通信来说，传输层是最高层；对于用户来说，传输层是最底层。非主机的网络设备(如路由器、网关)通常不涉及传输层的协议和功能，通常只有主机才涉及传输层的相关协议和功能。其主要功能如下：
1. 为进程与进程之间提供逻辑通信。
2. 复用和分用：
	1. 复用：应用层的所有应用进程都可以通过传输层传输到应用层
	2. 分用：传输层从网络层接收到的数据会交付给对应的应用进程(通过端口绑定应用)
3. 对网络层进行报文差错检测，可以可选地提供可靠传输。

其主要协议有：
1. TCP协议：
	- 是<font color="#c00000">面向连接</font>的传输控制协议
	- 传输数据需要建立连接
	- 接收方在收到数据后需要确认
	- 不提供广播或多播服务
	- 可靠，时延高
2. UDP协议：
	- 是无连接的用户数据报协议
	- 传输数据报前不需要建立连接
	- 接收端收到数据报后也不需要任何确认
	- 提供广播或多播服务
	- 不可靠，时延低

### 5.1.2 传输层的寻址与端口

端口号的划分(属于约定，不具有强制力)：
	端口号主要按范围进行划分，大致如下：
	1. 服务端使用的端口号：范围\[0, 49151\]，具体划分如下：
		1. 熟知端口号：\[0, 1023\]，主要分配给重要重要的应用程序，常见程序分配表如下：
			![[Pasted image 20240317161802.png]]
		2. 登记端口号：\[1024, 49151\]
	2. 客户端使用的端口号：范围\[0, 65535\]，在客户端程序运行时动态随机分配

在程序设计时，<font color="#c00000">通常用套接字绑定IP地址和端口号</font>(套接字，socket，意译为插槽)。

## 5.2 UDP协议

### 5.2.1 UDP数据报

UDP只是在IP数据报服务上提供了传输层的基本功能(即为进程提供socket逻辑通信，提供复用和分用)，其特点为：
1. UDP无连接，减少开销和时延
2. UDP和网络层一样尽最大努力交付，不保证可靠交付，即<font color="#c00000">不可靠传输</font>
3. UDP是面向报文的，<font color="#c00000">只添加了一个很小的分组首部</font>(<span style="background:#fff88f"><font color="#c00000">8 Byte</font></span>)，<span style="background:#fff88f"><font color="#c00000">对应用层报文既不合并又不拆分</font></span>，<font color="#c00000">一次发送一个完整报文</font>，需要应用自行分片，<font color="#c00000">也适合一次传输少量数据</font>：
	![[Pasted image 20240317163923.png]]
4. UDP无拥塞控制，适合实时性应用(即使网络拥塞，发送方依旧恒定速率发送)

UDP的首部格式：
	UDP首部只有8 Byte，只存了源端口、目的端口、UDP长度(<span style="background:#fff88f"><font color="#c00000">为整个UDP报文长度</font></span>)。源IP和目的IP在IP数据报中。<span style="background:#fff88f"><font color="#c00000">UDP包可以不要数据段，长度最少为8</font></span>。
	![[Pasted image 20240317165313.png]]
		当找不到目的端口时，则UDP数据报会被丢弃，<font color="#c00000">并发送ICMP端口不可达差错报文</font>。
		当UDP检验和校验错误，则UDP数据报会被丢弃。


