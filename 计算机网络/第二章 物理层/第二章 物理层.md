#计算机网络 #应试笔记与八股

## 目录
```toc

```

## 2.1 物理层基础特性

物理层主要负责<font color="#c00000">传输数据比特流</font>，而非具体的文件或媒体传输。其主要任务是确定传输媒体接口的一些有关特性，定义相关标准。

物理层主要定义内容如下：
1. 机械特性，例如引脚定义、接口封装、接插件机械设计等。
2. 电气特性，例如传输二进制位时，引线电压范围、阻抗匹配、传输速率以及距离限制等。
3. 功能特性，定义某导线上出现的某一电压表示的意义。
4. 规程特性(又叫过程特性)，定义各条物理线路的<font color="#9bbb59">工作流程</font>及<font color="#9bbb59">时序</font>关系。
注：
	电气特性和功能特性的区分为：
	`定义某两条差分线之间的电压为+10 ~ +15V时表示二进制位1，-10 ~ -15V时表示二进制位0`等<font color="#c00000">电压范围</font>时，则该定义为电气特性(通常给定具体的数字，以及范围)。
	`某协议的Busy与GND线路之间为高电平时表示当前线路忙`等<font color="#c00000">电平及其对应功能</font>时，则该定义为功能特性(通常不给具体数字)

## 2.2 通信基础

### 2.2.1 基本概念
通信的目的就是传送消息。消息包含文字、图片、视频等。

相关定义：
- <font color="#9bbb59">数据</font>：指传送信息的实体，通常是有意义的符号或二进制序列。
- <font color="#9bbb59">信号</font>：数据的电气/电磁等物理表现形式，是数据在传输过程中的存在形式。通常可分为数字信号和模拟信号。
- <font color="#9bbb59">信源</font>：发送和产生数据的源头，一般为各种终端。
- <font color="#9bbb59">信宿</font>：接收数据的终点。
- <font color="#9bbb59">信道</font>：信号的<font color="#c00000">一个方向上</font>的传输媒介，因此通常信道成对出现(见下方)。
	- 信道可以按传输信号分为数字信道和模拟信道
	- 信道也可以按传输介质分为有线信道和无线信道
- <font color="#9bbb59">码元</font>：指使用一个固定时长的信号波形能传输的数字信号的信息量。例如一个波形可以表示一个二进制，则就是1码元，<font color="#c00000">称为二级制码元</font>；可以表示四进制就是2码元，称为四进制码元；N进制就是 $\log_{2}(N)$ 码元，称为N进制码元。
- <font color="#9bbb59">码元宽度</font>：一个码元所使用的固定时长的时长宽度。
- <font color="#9bbb59">速率</font>、<font color="#9bbb59">数据率</font>、<font color="#9bbb59">数据传输速率</font>：表示单位时间内传输的数据量，可以按照单位不同分为如下两种说法：
	- <font color="#9bbb59">码元传输速率</font>、<span style="background:#fff88f"><font color="#9bbb59">波特率</font></span>：单位时间内传输的码元个数，单位波特(Baud)，例如2秒传输4800个码元，则波特率为2400<font color="#c00000">B</font>。码元速率与进制数无关，只与码元长度(码元宽度)有关。
	- <font color="#9bbb59">信息传输速率</font>、<font color="#9bbb59">比特率</font>：单位时间内传输的二进制码元个数，单位比特(bit)。
- <font color="#9bbb59">带宽</font>：在模拟系统和数字系统中有不同的定义，具体如下：
	- (模拟)<font color="#9bbb59">带宽</font>：当输入信号频率高或低到一定程度时，使得系统的输出功率成为输入功率的一半时(即-3dB)，最高频率和最低频率的差值就是系统的通频带宽，单位为Hz。
	- (数字)<font color="#9bbb59">带宽</font>：单位时间内从网络系统中的一点到另外一点所能通过的<font color="#c00000">最高</font>数据率(实际达不到)，单位是比特每秒，bps。

基本数据通信模型：
![[Pasted image 20240301202429.png]]

按通信双方信息交互的方式看，主要可以分为如下三种基本方式：
1. <font color="#9bbb59">单向通信</font>，只可单向通信，<font color="#c00000">只需要一条信道</font>。
2. <font color="#9bbb59">半双工通信</font>，通信双方可以双向通信，但是不可同时双向通信。<span style="background:#fff88f"><font color="#c00000">需要两条信道</font></span>。
3. <font color="#9bbb59">全双工通信</font>，通信双方可以同时双向通信。

按数据的各位传输方式可分为：
1. <font color="#9bbb59">串行通信</font>，一次只传输一个数据位，<font color="#c00000">速度慢、费用低、适合远距离</font>。
2. <font color="#9bbb59">并行通信</font>，一次可以传输多个数据位，<font color="#c00000">速度快、费用高、适合近距离</font>。

按数据传输是否有时钟同步可分为：
1. <font color="#9bbb59">同步通信</font>，传输时<font color="#c00000">有公共时钟</font>(例如USART接口需要额外的时钟引脚CK)，其每次都需要先发出同步<font color="#c00000">字符</font>(Byte)后才能进行数据传输，<span style="background:#fff88f"><font color="#c00000">是面向Byte的传输</font></span>。
2. <font color="#9bbb59">异步通信</font>，传输时<font color="#c00000">无公共时钟</font>(例如UART只需要TX、RX、GND)，采用应答方式，<font color="#c00000">接收方不知道发送方什么时候会发送数据，发送方也可以随时进行数据发送</font>，通常都需要一个字符的起始<font color="#c00000">位</font>(bit)和一个字符的终止位，接收方也通过抓取起始位和终止位进行"同步"，<span style="background:#fff88f"><font color="#c00000">是面向bit的传输</font></span>，传输效率低于同步传输。

### 2.2.2 奈奎斯特定理与香农定理

#### 2.2.2.1 奈奎斯特定理(奈式定理)

该定理描述的是一个信道在<span style="background:#fff88f"><font color="#c00000">低通</font></span>、<span style="background:#fff88f"><font color="#c00000">无噪声</font></span>、<span style="background:#fff88f"><font color="#c00000">带宽受限</font></span>的条件下<font color="#c00000">为了避免码间串扰</font>的极限<font color="#9bbb59">码元传输速率</font>，其中 $W$ 是理想低通信道的<font color="#c00000">(模拟)</font>带宽。
$$极限码元传输速率=2W$$
则该信道的极限<font color="#9bbb59">数据(data)传输速率</font>为：
$$数据传输速率=2W\log_{2}(V)$$
注：
1. 奈奎斯特定理<span style="background:#fff88f"><font color="#c00000">并未限制最高信息(imformation)传输速率</font></span>，因为我们可以采用调制方法、编码技术来提高信息传输速率。
2. 奈奎斯特定理限制的是<font color="#c00000">最高码元传输速率</font>。
3. 低通是指低于最高频率的所有信号都可以通过的信道，如下图就<font color="#c00000">不是</font>一个低通信道：
![[Pasted image 20240301211723.png]]
4. <font color="#c00000">信息传输速率可以大于数据传输速率</font>(但是这data和information的概念都不同为什么要进行比较...)。
因此(模拟)带宽越宽，就可以使用更高的速率进行信号传输。

#### 2.2.2.2 香农定理

该定理描述的是在<font color="#c00000">带宽受限</font>、<font color="#c00000">有噪声</font>的信道中，为了不产生误差的最大数据传输速率。
公式内容：
$$信道的极限数据传输速率=W\log_{2}(1+S/N)$$
$W$为带宽(Hz)，数据传输速率单位b/s。

有事可能会给出以分贝(dB)为单位的信噪比条件，概念如下：
- <font color="#9bbb59">信噪比</font>：信号的平均功率和噪声的平均功率之比，即：
$$信噪比(S/N)=\frac{信号平均功率}{噪声平均功率}$$
	当使用分贝(dB)作为单位时有：
$$信噪比(dB)=10 \log_{10}(S/N)$$

注：
1. S是信道的平均功率，N是信道内的<font color="#c00000">高斯噪声</font>功率。
2. 只要信息传输速率低于信道的极限数据传输速率，那么就<font color="#c00000">一定存在某种方法实现无差错的数据传输</font>。
3. 实际信道传输速率会比极限值低很多。
4. 显然，信噪比越高，传输速率越高。如果信噪比无穷大(不可能)，则信道带宽无穷大。

### 2.2.3 编码与调制

基本定义：
- <font color="#9bbb59">编码</font>：将数据变换为数字信号的过程就叫编码。
- <font color="#9bbb59">调制</font>：将数据变换为模拟信号的过程就叫调制。
- <font color="#9bbb59">基带信号</font>(baseband signal)：基带信号通常直接传输，或者经过简单的调制处理后传输，例如调幅(AM)调制。数字信号通常为基带信号。
- <font color="#9bbb59">宽带信号</font>(broadband signal)：宽带信号通常经过复杂的调制处理后传输，例如频率调制(FM)、相移键控(PSK)等。模拟信号通常为宽带信号。

在传输距离进时通常使用基带信号，距离远时通常使用宽带信号。

编码与调制方法：
- 数字数据 可以使用 <font color="#c00000">数字发送器</font>  编码 为 数字信号
- 数字数据 可以使用 <font color="#c00000">调制器</font>     调制 为 模拟信号
- 模拟数据 可以使用 <font color="#c00000">PCM编码器</font>  编码 为 数字信号
- 模拟数据 可以使用 <font color="#c00000">放大器调制器</font> 调制 为 模拟信号
可以通过数字信号或模拟信号的来源判定数据类型。

#### 2.2.3.1 数字数据编码为数字信号

<font color="#c00000">数字数据</font>转<font color="#c00000">数字信号</font>的编码可以根据规则不同大致分为如下几类：
	![[Pasted image 20240302222734.png]]

##### 2.2.3.1.1 非归零编码(NRZ)

定义：
	用高电平代表1、低电平代表0；或者高电平代表0、低电平代表1的编码即为归零编码。

优点：
	每个时钟周期内不需要归零(参见归零编码)，一个周期可以全部用来传输数据。

缺点：
	非归零编码无法传递时钟信号，双方难以同步。因此若需要传递高速数据则必须布置时钟线。

##### 2.2.3.1.2 归零编码(RZ)

定义：
	用高电平代表1、低电平代表0(或反之)，<font color="#c00000">并且每个时钟周期的中间均需要跳变到零电平的编码</font>即为归零编码。

优点：
	为传输双方提供了自同步机制

缺点：
	归零需要占用一些带宽，传输速度会受影响

##### 2.2.3.1.3 反向不归零编码(NRZI)

定义：
	信号电平翻转表示0，信号电平不变表示1。

优点：
	既能传输时钟，又能尽量不损失带宽

典型协议：USB2.0

##### 2.2.3.1.4 曼彻斯特编码

定义：
	前高后第表示1，前低后高表示0(或反之)。

优点：
	每一个码元中部一定会发生电平跳变，每一位既可以做时钟信号，也可以做数字信号。

缺点：
	其所占领的频带宽度是原始基带宽度的2倍。<font color="#c00000">数据传输速率只有调制速率的1/2</font>。

##### 2.2.3.1.5 差分曼彻斯特编码

定义：
	当前码元的前半段与前一个码元的后半段做比较，电平相同时为1，相异时为0。

优点：
	每个码元中间都有电平跳变以实现自同步，抗干扰性高于曼彻斯特编码。

常用于局域网传输。

##### 2.2.3.1.6 4B/5B编码

定义：
	在比特流中插入额外的比特以打破一连串的0或者1，即用5Bit来编码4Bit的数据，随后再进行传输，因此称作4B/5B编码，传输效率为80%。

编码对应表(部分)：
	![[Pasted image 20240303192030.png]]

简单分析可知，4Bit共有16种编码，而5Bit有32种编码。因此5Bit的额外16种编码被用来做控制码或保留码。
#### 2.2.3.2 数字数据调制为模拟信号

<font color="#c00000">数字数据</font>转<font color="#c00000">模拟信号</font>的调制主要有以下(3+1)种：
	![[Pasted image 20240303192608.png]]

##### 2.2.3.2.1 调幅(ASK)

例如：
	调节振幅来传输信息。

##### 2.2.3.2.2 调频(FSK)

例如：
	规定一个基础频率为0，规定2倍的基础频率为1，则通过调节频率变化传递信息的就叫调频。

##### 2.2.3.2.3 调相(PSK)

例如：
	定义正弦波的相位为0，余弦波的相位为1。

##### 2.2.3.2.4 正交振幅调制(QAM，ASK+PSK)

例如：
	调幅+调相的结合。

规定振幅调制中共有 `n` 种振幅，相位调制中有 `m` 种相位，波特率为 `B` ，则对应的 `QAM` 技术的数据传输速率为：
$$R=B log_{2}(mn)$$
单位b/s。

#### 2.2.3.3 模拟数据编码为数字信号

模拟数据编码为数字信号最典型的例子就是脉码调制(PCM)，其主要作用是将连续的模拟音频转化为有限个数字表示的离散序列，其主要有如下三个步骤：
1. 采样，对连续的模拟信号以一定频率进行采样，<font color="#c00000">为了保证离散信号能无失真的采样，必须保证采样频率大于等于二倍的信号最大频率</font>(<font color="#9bbb59">采样定理</font>)。
2. 量化，将连续的数据按一定的分级标度转化为对应的数字值，并取整数得到离散的数据量。
3. 编码，把量化的结果编码为二进制的编码。

<font color="#9bbb59">采样定理</font>：
	对于可以分解为若干有限频率正弦波的信号，可以由傅里叶变换分离出各个频率分量的幅值，则当采样频率大于最大频率二倍时才能被有效的成功采样。

#### 2.2.3.3 模拟数据调制为模拟信号

可以将较低的模拟数据调制到较高的模拟信号上以充分利用信道资源。

### 2.2.4 数据交换方式

由于在现实中不可能任意两台计算机之间都有一条独立的数据链路，因此需要实现数据交换。
![[Pasted image 20240303200018.png]]

数据交换方式主要有以下三种：
1. 电路交换
2. 报文交换
3. 分组交换
其中，后两种属于存储转发式的报文交换方式。

![[Pasted image 20240303215639 1.png]]

#### 2.2.4.1 电路交换

<font color="#c00000">独占</font>电路的交换方式就叫做电路交换，例如老式的电话接线员模式。
![[Pasted image 20240303200339.png]]
电路交换的过程中，每一个交换通道都需要保持一个独占的物理连接线路直到数据传输结束，其主要流程如下：
1. 建立连接，建立对应电路
2. 数据传输
3. 释放连接，拆除对应电路

优点主要有：
1. 传输时延小。
2. 数据顺序传输，无失序问题。
3. 实时性强，一旦建立物理链路即可实现实时通信。
4. 全双工通信，不会产生冲突。
5. 适用于数字信号的模拟信号。
6. 控制简单，电路交换的交换设备简单。

缺点主要有：
1. 建立连接所需时间长。
2. 信道独占，即使信道空闲，只要会话未结束均为独占状态，信道利用率低。
3. 灵活性差，一旦双方链路出现问题必须重新拨号建立新连接，不适用于突发通信。
4. 无数据存储能力，难以平滑通信量。
5. 电路交换中，不同类型、不同协议、不同规格的设备难以互相通信。
6. 无法发现和纠正错误，难以实现差错控制。

#### 2.2.4.2 报文(message)交换

<font color="#9bbb59">报文</font>：
	指网络中交换与传输的数据单元，即站点一次性要发送的数据块。包含目的地址、源地址、信息等。

报文交换原理：
	两个站点间各个节点对报文进行<font color="#c00000">存储</font>和<font color="#c00000">转发</font>。

优点主要有：
1. 无需建立连接，没有建立连接时延，用户可随时发送报文。
2. 动态分配线路，自动选择路径，平滑信息量。
3. 提高线路可靠性，某条线路出现故障时可以通过另一条路径进行传输。
4. 提高路线占用率，信道可以分时复用。
5. 提供多目标服务，一个报文可以发往多个目的地址。
6. 在存储转发中容易实现代码转换和速率匹配，增加了不同类型、不同协议、不同规格设备间的兼容性。

缺点主要有：
1. 实时性差，不适合实时性高的业务。
2. 只适用于数字信号。
3. 由于报文长度没有限制，而每个中间结点都要完整的接收整个报文，因此增加了缓冲区容量；有时还需要把报文缓存到磁盘上，增加了传送时延。

#### 2.2.4.2 分组(packet)交换

分组交换是目前互联网最常使用的一种交换方式。

由于大多数网络系统都无法传送任意长度的数据，因此需要对大的数据分割成小块，然后逐个发送。每一个块被称为分组(packet)，包含控制信息(源地址、目的地址、编号)和数据。

分组交换基本原理与报文交换基本相同，都是存储与转发。但是分组交换会限制数据单位的长度，一般限制为 `128B` 。

优点主要有：
1. 无建立时延，用户可随时发送分组。
2. 线路利用率高，信道可以分时复用。
3. 简化了存储管理，降低了缓冲区需求。
4. 加速传输，后一个分组的存储可以和前一个分组的转发并行操作，减少等待发送时间。
5. 减少出错几率和重发数据量，提高可靠性，降低传输时延。
6. 分组短小，适合计算机之间的突发性通信。

缺点主要有：
1. 仍存在分组转发时延。
2. 每个分组都要添加控制信息，一定程度上降低了通信效率，增加了处理的时间。
3. 当采用数据报服务时，分组可能出现失序、丢失和重复分组，需要进行重排操作；当采用虚电路服务时，会产生建立连接、数据传输和虚电路释放三个过程。详见下方两个小章节。

##### 2.2.4.2.1 基于数据报的分组交换

![[Pasted image 20240303215931 1.png]]

例如从主机A发送一系列分组到主机B，则有如下规则：
1. 分组(Packet)经历一系列节点，从A传输到B。
2. 每一层节点都会暂存当前数据报，下一级节点确认无差错后当前节点才会删除该数据报。
3. 一系列数据报可以同时经过多个路径从源到达目的。

特点：
1. 数据报提供的是<font color="#c00000">无连接服务</font>(区分于虚电路方式)，分组内不同数据报经过的路径可能不同。
2. 同一分组的不同数据报之间可能发生乱序、重复与丢失。
3. 每个分组在传输过程中都必须携带源地址和目的地址以及分组号。
4. 分组在交换节点间存储转发时都需要经过排队处理，可能带来一些排队时延。
5. 当大量数据报通过节点并发生网络拥塞时，可能会丢弃部分数据报。
6. 网络具有较强的冗余功能，某一节点出现故障可以更新转发表，对故障适应能力强，适用于突发事件。不适用于长报文、会话式通信。

##### 2.2.4.2.2 基于虚电路的分组交换

![[Pasted image 20240303220659 1.png]]

虚电路方式将数据报方式和电路交换方式相结合，发挥了两者的优点。其有如下规则：
1. 所有节点维持一张虚电路表，发送分组时需要先建立连接，从若干可能路径中建立一条 `虚电路` 。
2. 每个分组需要携带虚电路号、分组号、检验信息等控制信息。

特点：
1. 虚电路方式提供的是<font color="#c00000">连接服务</font>，从源到目的之间建立了一条逻辑连接(而非物理连接)。
2. 一次通信的所有分组都会通过虚电路顺序传送，分组无需携带源地址、目的地址等信息，但是需要携带虚电路号，开销相对较小。
3. 报文序列到达目的地址时不会乱序、重复和丢失。
4. 分组通过虚电路上的节点时，分组只进行差错检测，不需要路由选择。
5. 每个节点可与多个节点之间建立虚电路，可以进行流量控制。
6. <font color="#c00000">当网络中某个节点或某条链路出现故障而损坏时，所有经过该节点的虚电路将遭到破坏</font>。

## 2.3 物理层传输介质

定义：
- <font color="#9bbb59">传输介质</font>：传输介质是在数据传输系统中发送设备和接收设备之间的物理通路(双绞线、光纤等)
<font color="#c00000">传输介质不是物理层</font>，而物理层规定了电气特性，传输介质只是传输的物理通路，传输介质在物理层下方。

传输介质可以分为：
- <font color="#9bbb59">导向型传输介质</font>：例如电缆等
- <font color="#9bbb59">非导向型传输介质</font>：如空气(电磁波)、真空等。

### 2.3.1 导向型传输介质
#### 2.3.1.1 双绞线

![[Pasted image 20240303222609.png]]

特点：价格便宜、运用广泛。
当其传输数字信号时需要使用<font color="#9bbb59">中继器</font>将即将失真的信号整形并重新发送，当其传输模拟信号时需要使用<font color="#9bbb59">放大器</font>放大衰减的信号。

#### 2.3.1.2 同轴电缆

![[Pasted image 20240303222738.png]]

特点：有较强的抗干扰性(比双绞线强)、价格较双绞线贵、传输距离较双绞线远。

其中，传输基带信号的同轴电缆叫做<font color="#9bbb59">基带同轴电缆</font>，传输宽带信号的叫做<font color="#9bbb59">宽带同轴电缆</font>。

#### 2.3.1.3 光纤

![[Pasted image 20240303222920.png]]
特点：
1. 光纤是实心的，外侧有包层，可使光纤在光纤内部达成全反射。
2. 带宽远大于当前其他所有传输介质。
3. 传输距离远，长距离传输性价比高。
4. 保密性好。
5. 抗雷电和电磁干扰能力强。
6. 体积小、重量轻。

光纤按直径可分为：
1. <font color="#9bbb59">多模光纤</font>：有多种传输光信号模式的光纤，通常使用普通发光二极管，传输距离一般。
	![[Pasted image 20240303223203.png]]
2. <font color="#9bbb59">单模光纤</font>：光纤直径减小到一个光的波长时的光纤，衰减小，通常使用定向性很好的半导体激光器，<font color="#c00000">传输距离高</font>。
	![[Pasted image 20240303223223.png]]

### 2.3.2 非导向型介质

非导向型介质主要有：
1. 无线电波(<font color="#c00000">信号向所有方向传播</font>)，有较强的穿透能力，适合远距离传播
2. 微波(<font color="#c00000">信号传播方向固定</font>)，通信频率高，数据率高(地面微波接力通信、卫星通信)，但是误码率高，抗干扰能力低。
3. 红外线、激光(<font color="#c00000">信号传播方向固定</font>)

## 2.4 物理层设备

### 2.4.1 中继器

由于传输损耗，数字信号在线路上传输时会造成损耗，因此需要中继器对信号进行<font color="#c00000">再生和还原</font>。

注意：

1. <font color="#c00000">中继器两端是网段而不是子网</font>，适用于完全相同的两类网络的连接，且两个网段速率要相同。
2. <font color="#c00000">中继器只负责电气信号的放大</font>，不负责检查错误或不适于网段的数据，中继器两端也一定是同一个协议。
3. 理论中中继器的上限不做限制，但是由于要考虑网络延迟，实际上中继器的个数有上限。在10BASE5(一种以太网标准，规定10Mbps，曼彻斯特编码，单端大致传输距离为500m)中规定<span style="background:#fff88f">中继器个数最多为4、且由4个中继器划分的5段通信介质中只有3段可以挂接计算机，其余两段只可做拓展通信范围的链路段</span>。(<font color="#c00000">5-4-3规则</font>)


### 2.4.2 集线器






## 本章Q&A

1. 奈氏准则和香农定理的区别：
<details>
<summary>答案</summary>
1. 奈氏准则主要关注于码间串扰，香农主要关注于噪声。
2. 香农定理离不开噪声条件。如果未给出噪声条件，则应使用奈式；如果题目给出噪声，则两种定理都要算并取小值。
</details>








