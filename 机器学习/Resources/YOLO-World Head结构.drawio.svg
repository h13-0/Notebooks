<?xml version="1.0" encoding="UTF-8"?>
<!-- Do not edit this file with editors other than draw.io -->
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg xmlns="http://www.w3.org/2000/svg" style="background: transparent; background-color: transparent; color-scheme: light dark;" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="1659px" height="3143px" viewBox="-0.5 -0.5 1659 3143" content="&lt;mxfile host=&quot;Electron&quot; agent=&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) draw.io/26.1.1 Chrome/132.0.6834.210 Electron/34.3.3 Safari/537.36&quot; version=&quot;26.1.1&quot;&gt;&#10;  &lt;diagram name=&quot;第 1 页&quot; id=&quot;mdhD6ofBQQdLTaxG2Ajn&quot;&gt;&#10;    &lt;mxGraphModel dx=&quot;1669&quot; dy=&quot;568&quot; grid=&quot;1&quot; gridSize=&quot;10&quot; guides=&quot;1&quot; tooltips=&quot;1&quot; connect=&quot;1&quot; arrows=&quot;1&quot; fold=&quot;1&quot; page=&quot;1&quot; pageScale=&quot;1&quot; pageWidth=&quot;827&quot; pageHeight=&quot;1169&quot; math=&quot;0&quot; shadow=&quot;0&quot;&gt;&#10;      &lt;root&gt;&#10;        &lt;mxCell id=&quot;0&quot; /&gt;&#10;        &lt;mxCell id=&quot;1&quot; parent=&quot;0&quot; /&gt;&#10;        &lt;mxCell id=&quot;2WVR7MN8O9z0GEFoPHoW-150&quot; value=&quot;cv4: BnContrastiveHead：&amp;lt;blockquote style=&amp;quot;margin: 0 0 0 40px; border: none; padding: 0px;&amp;quot;&amp;gt;&amp;lt;div&amp;gt;x = x.norm&amp;lt;/div&amp;gt;&amp;lt;/blockquote&amp;gt;&amp;lt;blockquote style=&amp;quot;margin: 0 0 0 40px; border: none; padding: 0px;&amp;quot;&amp;gt;&amp;lt;div&amp;gt;对w的最后一个维度进行单位化&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;逐元素执行：x[b, k, h, w] = x[b, c, h, w] * w[b, k, c]&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;x = x * e^{k} + b&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;return x&amp;lt;/div&amp;gt;&amp;lt;/blockquote&amp;gt;&quot; style=&quot;rounded=0;whiteSpace=wrap;html=1;align=left;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;100&quot; y=&quot;1270&quot; width=&quot;340&quot; height=&quot;150&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;2WVR7MN8O9z0GEFoPHoW-151&quot; value=&quot;x: Image Feat&quot; style=&quot;rounded=0;whiteSpace=wrap;html=1;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;100&quot; y=&quot;1240&quot; width=&quot;170&quot; height=&quot;30&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;2WVR7MN8O9z0GEFoPHoW-152&quot; value=&quot;w: Text Feat&quot; style=&quot;rounded=0;whiteSpace=wrap;html=1;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;270&quot; y=&quot;1240&quot; width=&quot;170&quot; height=&quot;30&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;2WVR7MN8O9z0GEFoPHoW-202&quot; style=&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;&quot; parent=&quot;1&quot; source=&quot;2WVR7MN8O9z0GEFoPHoW-153&quot; target=&quot;2WVR7MN8O9z0GEFoPHoW-171&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;2WVR7MN8O9z0GEFoPHoW-153&quot; value=&quot;&amp;lt;div style=&amp;quot;&amp;quot;&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;Return: Similiarity Score&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;blockquote style=&amp;quot;margin: 0 0 0 40px; border: none; padding: 0px;&amp;quot;&amp;gt;&amp;lt;div&amp;gt;Tensor: (batch, k, 20, 20)&amp;lt;/div&amp;gt;&amp;lt;/blockquote&amp;gt;&quot; style=&quot;rounded=0;whiteSpace=wrap;html=1;align=left;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;100&quot; y=&quot;1420&quot; width=&quot;340&quot; height=&quot;60&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;2WVR7MN8O9z0GEFoPHoW-93&quot; value=&quot;cv2: Conv+SiLU：&amp;lt;blockquote style=&amp;quot;margin: 0px 0px 0px 40px; border: none; padding: 0px;&amp;quot;&amp;gt;两次Conv(3, 3)+SiLU&amp;lt;/blockquote&amp;gt;&amp;lt;blockquote style=&amp;quot;margin: 0px 0px 0px 40px; border: none; padding: 0px;&amp;quot;&amp;gt;一次Conv(1, 1)&amp;lt;/blockquote&amp;gt;&amp;lt;blockquote style=&amp;quot;margin: 0px 0px 0px 40px; border: none; padding: 0px;&amp;quot;&amp;gt;最终输出宽高与输入相同，输出channel=&amp;lt;span style=&amp;quot;text-align: center; background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;reg_max*4&amp;lt;/span&amp;gt;&amp;lt;/blockquote&amp;gt;&quot; style=&quot;rounded=0;whiteSpace=wrap;html=1;align=left;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;-590&quot; y=&quot;1330&quot; width=&quot;320&quot; height=&quot;80&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;2WVR7MN8O9z0GEFoPHoW-94&quot; value=&quot;x: Image Feature&quot; style=&quot;rounded=0;whiteSpace=wrap;html=1;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;-590&quot; y=&quot;1300&quot; width=&quot;320&quot; height=&quot;30&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;2WVR7MN8O9z0GEFoPHoW-115&quot; style=&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;&quot; parent=&quot;1&quot; source=&quot;2WVR7MN8O9z0GEFoPHoW-95&quot; target=&quot;2WVR7MN8O9z0GEFoPHoW-73&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;2WVR7MN8O9z0GEFoPHoW-95&quot; value=&quot;Return: (batch, 64, 20, 20)&quot; style=&quot;rounded=0;whiteSpace=wrap;html=1;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;-590&quot; y=&quot;1410&quot; width=&quot;320&quot; height=&quot;40&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;TavXo0WUxr7w91VWTHu4-55&quot; style=&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;&quot; parent=&quot;1&quot; source=&quot;2WVR7MN8O9z0GEFoPHoW-2&quot; target=&quot;2WVR7MN8O9z0GEFoPHoW-198&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;2WVR7MN8O9z0GEFoPHoW-2&quot; value=&quot;texts:&amp;lt;div&amp;gt;prompt 1&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;prompt 2&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;...&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;prompt k&amp;lt;/div&amp;gt;&quot; style=&quot;rounded=0;whiteSpace=wrap;html=1;dashed=1;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;590&quot; y=&quot;120&quot; width=&quot;200&quot; height=&quot;100&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;2WVR7MN8O9z0GEFoPHoW-5&quot; value=&quot;&quot; style=&quot;endArrow=none;dashed=1;html=1;rounded=0;exitX=0;exitY=0;exitDx=0;exitDy=0;&quot; parent=&quot;1&quot; source=&quot;2WVR7MN8O9z0GEFoPHoW-6&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry width=&quot;50&quot; height=&quot;50&quot; relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;-480&quot; y=&quot;520&quot; as=&quot;sourcePoint&quot; /&gt;&#10;            &lt;mxPoint x=&quot;830&quot; y=&quot;520&quot; as=&quot;targetPoint&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;2WVR7MN8O9z0GEFoPHoW-6&quot; value=&quot;Head&quot; style=&quot;text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;-827&quot; y=&quot;520&quot; width=&quot;60&quot; height=&quot;30&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;2WVR7MN8O9z0GEFoPHoW-110&quot; style=&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;&quot; parent=&quot;1&quot; source=&quot;2WVR7MN8O9z0GEFoPHoW-20&quot; target=&quot;2WVR7MN8O9z0GEFoPHoW-103&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;2WVR7MN8O9z0GEFoPHoW-20&quot; value=&quot;&amp;lt;div style=&amp;quot;&amp;quot;&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;Image Feature:&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;blockquote style=&amp;quot;margin: 0 0 0 40px; border: none; padding: 0px;&amp;quot;&amp;gt;&amp;lt;div style=&amp;quot;&amp;quot;&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;Tensor(batch, 192, 80, 80)&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;/blockquote&amp;gt;&quot; style=&quot;rounded=0;whiteSpace=wrap;html=1;align=left;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;-440&quot; y=&quot;360&quot; width=&quot;210&quot; height=&quot;120&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;2WVR7MN8O9z0GEFoPHoW-111&quot; style=&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;&quot; parent=&quot;1&quot; source=&quot;2WVR7MN8O9z0GEFoPHoW-21&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;-95.11111111111131&quot; y=&quot;560.0000000000002&quot; as=&quot;targetPoint&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;2WVR7MN8O9z0GEFoPHoW-21&quot; value=&quot;&amp;lt;div style=&amp;quot;&amp;quot;&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;Image Feature:&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;blockquote style=&amp;quot;margin: 0 0 0 40px; border: none; padding: 0px;&amp;quot;&amp;gt;&amp;lt;div style=&amp;quot;&amp;quot;&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;Tensor(batch, 384, 40, 40)&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;/blockquote&amp;gt;&quot; style=&quot;rounded=0;whiteSpace=wrap;html=1;align=left;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;-200&quot; y=&quot;360&quot; width=&quot;210&quot; height=&quot;120&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;2WVR7MN8O9z0GEFoPHoW-112&quot; style=&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;&quot; parent=&quot;1&quot; source=&quot;2WVR7MN8O9z0GEFoPHoW-22&quot; target=&quot;2WVR7MN8O9z0GEFoPHoW-103&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;2WVR7MN8O9z0GEFoPHoW-22&quot; value=&quot;&amp;lt;div style=&amp;quot;&amp;quot;&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;Image Feature:&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;blockquote style=&amp;quot;margin: 0 0 0 40px; border: none; padding: 0px;&amp;quot;&amp;gt;&amp;lt;div style=&amp;quot;&amp;quot;&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;Tensor(batch, 576, 20, 20)&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;/blockquote&amp;gt;&quot; style=&quot;rounded=0;whiteSpace=wrap;html=1;align=left;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;40&quot; y=&quot;360&quot; width=&quot;210&quot; height=&quot;120&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;2WVR7MN8O9z0GEFoPHoW-59&quot; value=&quot;cv2: Conv+SiLU：&amp;lt;blockquote style=&amp;quot;margin: 0px 0px 0px 40px; border: none; padding: 0px;&amp;quot;&amp;gt;两次Conv(3, 3)+SiLU&amp;lt;/blockquote&amp;gt;&amp;lt;blockquote style=&amp;quot;margin: 0px 0px 0px 40px; border: none; padding: 0px;&amp;quot;&amp;gt;一次Conv(1, 1)&amp;lt;/blockquote&amp;gt;&amp;lt;blockquote style=&amp;quot;margin: 0px 0px 0px 40px; border: none; padding: 0px;&amp;quot;&amp;gt;最终输出宽高与输入相同，输出channel=&amp;lt;span style=&amp;quot;text-align: center; background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;reg_max*4&amp;lt;/span&amp;gt;&amp;lt;/blockquote&amp;gt;&quot; style=&quot;rounded=0;whiteSpace=wrap;html=1;align=left;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;-600&quot; y=&quot;1320&quot; width=&quot;320&quot; height=&quot;80&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;2WVR7MN8O9z0GEFoPHoW-60&quot; value=&quot;x: Image Feature&quot; style=&quot;rounded=0;whiteSpace=wrap;html=1;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;-600&quot; y=&quot;1290&quot; width=&quot;320&quot; height=&quot;30&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;2WVR7MN8O9z0GEFoPHoW-114&quot; style=&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;&quot; parent=&quot;1&quot; source=&quot;2WVR7MN8O9z0GEFoPHoW-62&quot; target=&quot;2WVR7MN8O9z0GEFoPHoW-72&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;2WVR7MN8O9z0GEFoPHoW-62&quot; value=&quot;Return: (batch, 64, 40, 40)&quot; style=&quot;rounded=0;whiteSpace=wrap;html=1;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;-600&quot; y=&quot;1400&quot; width=&quot;320&quot; height=&quot;40&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;2WVR7MN8O9z0GEFoPHoW-63&quot; value=&quot;cv2: Conv+SiLU：&amp;lt;blockquote style=&amp;quot;margin: 0 0 0 40px; border: none; padding: 0px;&amp;quot;&amp;gt;两次Conv(3, 3)+SiLU&amp;lt;/blockquote&amp;gt;&amp;lt;blockquote style=&amp;quot;margin: 0 0 0 40px; border: none; padding: 0px;&amp;quot;&amp;gt;一次Conv(1, 1)&amp;lt;/blockquote&amp;gt;&amp;lt;blockquote style=&amp;quot;margin: 0 0 0 40px; border: none; padding: 0px;&amp;quot;&amp;gt;最终输出宽高与输入相同，输出channel=&amp;lt;span style=&amp;quot;text-align: center; background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;reg_max*4&amp;lt;/span&amp;gt;&amp;lt;/blockquote&amp;gt;&quot; style=&quot;rounded=0;whiteSpace=wrap;html=1;align=left;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;-610&quot; y=&quot;1310&quot; width=&quot;320&quot; height=&quot;80&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;2WVR7MN8O9z0GEFoPHoW-64&quot; value=&quot;x: Image Feature&quot; style=&quot;rounded=0;whiteSpace=wrap;html=1;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;-610&quot; y=&quot;1280&quot; width=&quot;320&quot; height=&quot;30&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;2WVR7MN8O9z0GEFoPHoW-113&quot; style=&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;&quot; parent=&quot;1&quot; source=&quot;2WVR7MN8O9z0GEFoPHoW-66&quot; target=&quot;2WVR7MN8O9z0GEFoPHoW-71&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;2WVR7MN8O9z0GEFoPHoW-66&quot; value=&quot;Return: (batch, reg_max*4, 80, 80)&quot; style=&quot;rounded=0;whiteSpace=wrap;html=1;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;-610&quot; y=&quot;1390&quot; width=&quot;320&quot; height=&quot;40&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;2WVR7MN8O9z0GEFoPHoW-189&quot; style=&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;&quot; parent=&quot;1&quot; source=&quot;2WVR7MN8O9z0GEFoPHoW-71&quot; target=&quot;2WVR7MN8O9z0GEFoPHoW-183&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;2WVR7MN8O9z0GEFoPHoW-71&quot; value=&quot;&amp;lt;div style=&amp;quot;&amp;quot;&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;Image Feature:&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div style=&amp;quot;&amp;quot;&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;&amp;amp;nbsp; &amp;amp;nbsp; Tensor(batch,&amp;amp;nbsp;&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); text-align: center;&amp;quot;&amp;gt;reg_max*4&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;, 80, 80)&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&quot; style=&quot;rounded=0;whiteSpace=wrap;html=1;align=left;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;-770&quot; y=&quot;1525&quot; width=&quot;210&quot; height=&quot;120&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;2WVR7MN8O9z0GEFoPHoW-190&quot; style=&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;&quot; parent=&quot;1&quot; source=&quot;2WVR7MN8O9z0GEFoPHoW-72&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;-90&quot; y=&quot;1700&quot; as=&quot;targetPoint&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;2WVR7MN8O9z0GEFoPHoW-72&quot; value=&quot;&amp;lt;div style=&amp;quot;&amp;quot;&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;Image Feature:&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div style=&amp;quot;&amp;quot;&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;&amp;amp;nbsp; &amp;amp;nbsp; Tensor(batch,&amp;amp;nbsp;&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); text-align: center;&amp;quot;&amp;gt;reg_max*4&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;, 40, 40)&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&quot; style=&quot;rounded=0;whiteSpace=wrap;html=1;align=left;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;-545&quot; y=&quot;1525&quot; width=&quot;210&quot; height=&quot;120&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;2WVR7MN8O9z0GEFoPHoW-191&quot; style=&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;&quot; parent=&quot;1&quot; source=&quot;2WVR7MN8O9z0GEFoPHoW-73&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;-90&quot; y=&quot;1700&quot; as=&quot;targetPoint&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;2WVR7MN8O9z0GEFoPHoW-73&quot; value=&quot;&amp;lt;div style=&amp;quot;&amp;quot;&amp;gt;&amp;lt;div&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;Image Feature:&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;&amp;amp;nbsp; &amp;amp;nbsp; Tensor(batch,&amp;amp;nbsp;&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); text-align: center;&amp;quot;&amp;gt;reg_max*4&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;, 20, 20)&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;/div&amp;gt;&quot; style=&quot;rounded=0;whiteSpace=wrap;html=1;align=left;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;-320&quot; y=&quot;1525&quot; width=&quot;210&quot; height=&quot;120&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;2WVR7MN8O9z0GEFoPHoW-77&quot; value=&quot;cv3: Conv+SiLU：&amp;lt;blockquote style=&amp;quot;margin: 0 0 0 40px; border: none; padding: 0px;&amp;quot;&amp;gt;第一次Conv(3, 3)+SiLU降维到192&amp;lt;/blockquote&amp;gt;&amp;lt;blockquote style=&amp;quot;margin: 0 0 0 40px; border: none; padding: 0px;&amp;quot;&amp;gt;第二次Conv(3, 3)+SiLU维度不变(192)&amp;lt;/blockquote&amp;gt;&amp;lt;blockquote style=&amp;quot;margin: 0 0 0 40px; border: none; padding: 0px;&amp;quot;&amp;gt;最后Conv(1, 1)升维到512&amp;lt;/blockquote&amp;gt;&amp;lt;blockquote style=&amp;quot;margin: 0 0 0 40px; border: none; padding: 0px;&amp;quot;&amp;gt;最终输出宽高与输入相同，输出channel=512&amp;lt;/blockquote&amp;gt;&quot; style=&quot;rounded=0;whiteSpace=wrap;html=1;align=left;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;110&quot; y=&quot;725&quot; width=&quot;320&quot; height=&quot;80&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;2WVR7MN8O9z0GEFoPHoW-78&quot; value=&quot;x: Image Feature&quot; style=&quot;rounded=0;whiteSpace=wrap;html=1;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;110&quot; y=&quot;695&quot; width=&quot;320&quot; height=&quot;30&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;2WVR7MN8O9z0GEFoPHoW-124&quot; style=&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;&quot; parent=&quot;1&quot; source=&quot;2WVR7MN8O9z0GEFoPHoW-79&quot; target=&quot;2WVR7MN8O9z0GEFoPHoW-121&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;2WVR7MN8O9z0GEFoPHoW-79&quot; value=&quot;Return: (batch, 512, 40, 40)&quot; style=&quot;rounded=0;whiteSpace=wrap;html=1;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;110&quot; y=&quot;805&quot; width=&quot;320&quot; height=&quot;40&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;2WVR7MN8O9z0GEFoPHoW-74&quot; value=&quot;cv3: Conv+SiLU：&amp;lt;blockquote style=&amp;quot;margin: 0 0 0 40px; border: none; padding: 0px;&amp;quot;&amp;gt;第一次Conv(3, 3)+SiLU降维到192&amp;lt;/blockquote&amp;gt;&amp;lt;blockquote style=&amp;quot;margin: 0 0 0 40px; border: none; padding: 0px;&amp;quot;&amp;gt;第二次Conv(3, 3)+SiLU维度不变(192)&amp;lt;/blockquote&amp;gt;&amp;lt;blockquote style=&amp;quot;margin: 0 0 0 40px; border: none; padding: 0px;&amp;quot;&amp;gt;最后Conv(1, 1)升维到512&amp;lt;/blockquote&amp;gt;&amp;lt;blockquote style=&amp;quot;margin: 0 0 0 40px; border: none; padding: 0px;&amp;quot;&amp;gt;最终输出宽高与输入相同，输出channel=512&amp;lt;/blockquote&amp;gt;&quot; style=&quot;rounded=0;whiteSpace=wrap;html=1;align=left;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;100&quot; y=&quot;715&quot; width=&quot;320&quot; height=&quot;80&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;2WVR7MN8O9z0GEFoPHoW-75&quot; value=&quot;x: Image Feature&quot; style=&quot;rounded=0;whiteSpace=wrap;html=1;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;100&quot; y=&quot;685&quot; width=&quot;320&quot; height=&quot;30&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;2WVR7MN8O9z0GEFoPHoW-123&quot; style=&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;&quot; parent=&quot;1&quot; source=&quot;2WVR7MN8O9z0GEFoPHoW-76&quot; target=&quot;2WVR7MN8O9z0GEFoPHoW-120&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;2WVR7MN8O9z0GEFoPHoW-76&quot; value=&quot;Return: (batch, 512, 40, 40)&quot; style=&quot;rounded=0;whiteSpace=wrap;html=1;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;100&quot; y=&quot;795&quot; width=&quot;320&quot; height=&quot;40&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;2WVR7MN8O9z0GEFoPHoW-67&quot; value=&quot;cv3: Conv+SiLU：&amp;lt;blockquote style=&amp;quot;margin: 0 0 0 40px; border: none; padding: 0px;&amp;quot;&amp;gt;第一次Conv(3, 3)+SiLU降维到192&amp;lt;/blockquote&amp;gt;&amp;lt;blockquote style=&amp;quot;margin: 0 0 0 40px; border: none; padding: 0px;&amp;quot;&amp;gt;第二次Conv(3, 3)+SiLU维度不变(192)&amp;lt;/blockquote&amp;gt;&amp;lt;blockquote style=&amp;quot;margin: 0 0 0 40px; border: none; padding: 0px;&amp;quot;&amp;gt;最后Conv(1, 1)升维到512&amp;lt;/blockquote&amp;gt;&amp;lt;blockquote style=&amp;quot;margin: 0 0 0 40px; border: none; padding: 0px;&amp;quot;&amp;gt;最终输出宽高与输入相同，输出channel=512&amp;lt;/blockquote&amp;gt;&quot; style=&quot;rounded=0;whiteSpace=wrap;html=1;align=left;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;90&quot; y=&quot;705&quot; width=&quot;320&quot; height=&quot;80&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;2WVR7MN8O9z0GEFoPHoW-68&quot; value=&quot;x: Image Feature&quot; style=&quot;rounded=0;whiteSpace=wrap;html=1;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;90&quot; y=&quot;675&quot; width=&quot;320&quot; height=&quot;30&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;2WVR7MN8O9z0GEFoPHoW-122&quot; style=&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;&quot; parent=&quot;1&quot; source=&quot;2WVR7MN8O9z0GEFoPHoW-70&quot; target=&quot;2WVR7MN8O9z0GEFoPHoW-119&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;2WVR7MN8O9z0GEFoPHoW-70&quot; value=&quot;Return: (batch, 512, 80, 80)&quot; style=&quot;rounded=0;whiteSpace=wrap;html=1;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;90&quot; y=&quot;785&quot; width=&quot;320&quot; height=&quot;40&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;2WVR7MN8O9z0GEFoPHoW-108&quot; style=&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;&quot; parent=&quot;1&quot; source=&quot;2WVR7MN8O9z0GEFoPHoW-103&quot; target=&quot;2WVR7MN8O9z0GEFoPHoW-64&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;Array as=&quot;points&quot;&gt;&#10;              &lt;mxPoint x=&quot;-95&quot; y=&quot;640&quot; /&gt;&#10;              &lt;mxPoint x=&quot;-450&quot; y=&quot;640&quot; /&gt;&#10;            &lt;/Array&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;2WVR7MN8O9z0GEFoPHoW-109&quot; style=&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;&quot; parent=&quot;1&quot; source=&quot;2WVR7MN8O9z0GEFoPHoW-103&quot; target=&quot;2WVR7MN8O9z0GEFoPHoW-68&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;Array as=&quot;points&quot;&gt;&#10;              &lt;mxPoint x=&quot;-95&quot; y=&quot;640&quot; /&gt;&#10;              &lt;mxPoint x=&quot;250&quot; y=&quot;640&quot; /&gt;&#10;            &lt;/Array&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;2WVR7MN8O9z0GEFoPHoW-103&quot; value=&quot;&amp;lt;div style=&amp;quot;&amp;quot;&amp;gt;Image Feature List[3]&amp;lt;/div&amp;gt;&quot; style=&quot;rounded=0;whiteSpace=wrap;html=1;align=center;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;-440&quot; y=&quot;560&quot; width=&quot;690&quot; height=&quot;40&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;2WVR7MN8O9z0GEFoPHoW-130&quot; style=&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;&quot; parent=&quot;1&quot; source=&quot;2WVR7MN8O9z0GEFoPHoW-119&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;259.99999999999955&quot; y=&quot;1080&quot; as=&quot;targetPoint&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;2WVR7MN8O9z0GEFoPHoW-119&quot; value=&quot;&amp;lt;div style=&amp;quot;&amp;quot;&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;Image Feature:&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;blockquote style=&amp;quot;margin: 0 0 0 40px; border: none; padding: 0px;&amp;quot;&amp;gt;&amp;lt;div style=&amp;quot;&amp;quot;&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;Tensor(batch, 512, 80, 80)&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;/blockquote&amp;gt;&quot; style=&quot;rounded=0;whiteSpace=wrap;html=1;align=left;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;-70&quot; y=&quot;920&quot; width=&quot;210&quot; height=&quot;120&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;2WVR7MN8O9z0GEFoPHoW-131&quot; style=&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;&quot; parent=&quot;1&quot; source=&quot;2WVR7MN8O9z0GEFoPHoW-120&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;259.99999999999955&quot; y=&quot;1080&quot; as=&quot;targetPoint&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;2WVR7MN8O9z0GEFoPHoW-120&quot; value=&quot;&amp;lt;div style=&amp;quot;&amp;quot;&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;Image Feature:&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;blockquote style=&amp;quot;margin: 0 0 0 40px; border: none; padding: 0px;&amp;quot;&amp;gt;&amp;lt;div style=&amp;quot;&amp;quot;&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;Tensor(batch, 512, 40, 40)&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;/blockquote&amp;gt;&quot; style=&quot;rounded=0;whiteSpace=wrap;html=1;align=left;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;155&quot; y=&quot;920&quot; width=&quot;210&quot; height=&quot;120&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;2WVR7MN8O9z0GEFoPHoW-132&quot; style=&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;&quot; parent=&quot;1&quot; source=&quot;2WVR7MN8O9z0GEFoPHoW-121&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;259.99999999999955&quot; y=&quot;1080&quot; as=&quot;targetPoint&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;2WVR7MN8O9z0GEFoPHoW-121&quot; value=&quot;&amp;lt;div style=&amp;quot;&amp;quot;&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;Image Feature:&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;blockquote style=&amp;quot;margin: 0 0 0 40px; border: none; padding: 0px;&amp;quot;&amp;gt;&amp;lt;div style=&amp;quot;&amp;quot;&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;Tensor(batch, 512, 20, 20)&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;/blockquote&amp;gt;&quot; style=&quot;rounded=0;whiteSpace=wrap;html=1;align=left;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;380&quot; y=&quot;920&quot; width=&quot;210&quot; height=&quot;120&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;2WVR7MN8O9z0GEFoPHoW-145&quot; value=&quot;cv4: BnContrastiveHead：&amp;lt;blockquote style=&amp;quot;margin: 0 0 0 40px; border: none; padding: 0px;&amp;quot;&amp;gt;&amp;lt;div&amp;gt;x = x.norm&amp;lt;/div&amp;gt;&amp;lt;/blockquote&amp;gt;&amp;lt;blockquote style=&amp;quot;margin: 0 0 0 40px; border: none; padding: 0px;&amp;quot;&amp;gt;&amp;lt;div&amp;gt;对w的最后一个维度进行单位化&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;逐元素执行：x[b, k, h, w] = x[b, c, h, w] * w[b, k, c]&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;x = x * e^{k} + b&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;return x&amp;lt;/div&amp;gt;&amp;lt;/blockquote&amp;gt;&quot; style=&quot;rounded=0;whiteSpace=wrap;html=1;align=left;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;90&quot; y=&quot;1260&quot; width=&quot;340&quot; height=&quot;150&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;2WVR7MN8O9z0GEFoPHoW-146&quot; value=&quot;x: Image Feat&quot; style=&quot;rounded=0;whiteSpace=wrap;html=1;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;90&quot; y=&quot;1230&quot; width=&quot;170&quot; height=&quot;30&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;2WVR7MN8O9z0GEFoPHoW-147&quot; value=&quot;w: Text Feat&quot; style=&quot;rounded=0;whiteSpace=wrap;html=1;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;260&quot; y=&quot;1230&quot; width=&quot;170&quot; height=&quot;30&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;2WVR7MN8O9z0GEFoPHoW-201&quot; style=&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;&quot; parent=&quot;1&quot; source=&quot;2WVR7MN8O9z0GEFoPHoW-148&quot; target=&quot;2WVR7MN8O9z0GEFoPHoW-170&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;2WVR7MN8O9z0GEFoPHoW-148&quot; value=&quot;&amp;lt;div style=&amp;quot;&amp;quot;&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;Return: Similiarity Score&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;blockquote style=&amp;quot;margin: 0 0 0 40px; border: none; padding: 0px;&amp;quot;&amp;gt;&amp;lt;div&amp;gt;Tensor: (batch, k, 40, 40)&amp;lt;/div&amp;gt;&amp;lt;/blockquote&amp;gt;&quot; style=&quot;rounded=0;whiteSpace=wrap;html=1;align=left;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;90&quot; y=&quot;1410&quot; width=&quot;340&quot; height=&quot;60&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;2WVR7MN8O9z0GEFoPHoW-7&quot; value=&quot;cv4: BnContrastiveHead：&amp;lt;blockquote style=&amp;quot;margin: 0 0 0 40px; border: none; padding: 0px;&amp;quot;&amp;gt;&amp;lt;div&amp;gt;x = x.norm&amp;lt;/div&amp;gt;&amp;lt;/blockquote&amp;gt;&amp;lt;blockquote style=&amp;quot;margin: 0 0 0 40px; border: none; padding: 0px;&amp;quot;&amp;gt;&amp;lt;div&amp;gt;对w的最后一个维度进行单位化&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;逐元素执行：x[b, k, h, w] = x[b, c, h, w] * w[b, k, c]&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;x = x * e^{k} + b&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;return x&amp;lt;/div&amp;gt;&amp;lt;/blockquote&amp;gt;&quot; style=&quot;rounded=0;whiteSpace=wrap;html=1;align=left;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;80&quot; y=&quot;1250&quot; width=&quot;340&quot; height=&quot;150&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;2WVR7MN8O9z0GEFoPHoW-9&quot; value=&quot;x: Image Feat&quot; style=&quot;rounded=0;whiteSpace=wrap;html=1;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;80&quot; y=&quot;1220&quot; width=&quot;170&quot; height=&quot;30&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;2WVR7MN8O9z0GEFoPHoW-10&quot; value=&quot;w: Text Feat&quot; style=&quot;rounded=0;whiteSpace=wrap;html=1;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;250&quot; y=&quot;1220&quot; width=&quot;170&quot; height=&quot;30&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;2WVR7MN8O9z0GEFoPHoW-200&quot; style=&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;&quot; parent=&quot;1&quot; source=&quot;2WVR7MN8O9z0GEFoPHoW-12&quot; target=&quot;2WVR7MN8O9z0GEFoPHoW-169&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;2WVR7MN8O9z0GEFoPHoW-12&quot; value=&quot;&amp;lt;div style=&amp;quot;&amp;quot;&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;Return: Similiarity Score&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;blockquote style=&amp;quot;margin: 0 0 0 40px; border: none; padding: 0px;&amp;quot;&amp;gt;&amp;lt;div&amp;gt;Tensor: (batch, k, 80, 80)&amp;lt;/div&amp;gt;&amp;lt;/blockquote&amp;gt;&quot; style=&quot;rounded=0;whiteSpace=wrap;html=1;align=left;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;80&quot; y=&quot;1400&quot; width=&quot;340&quot; height=&quot;60&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;2WVR7MN8O9z0GEFoPHoW-168&quot; style=&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;&quot; parent=&quot;1&quot; source=&quot;2WVR7MN8O9z0GEFoPHoW-163&quot; target=&quot;2WVR7MN8O9z0GEFoPHoW-9&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;2WVR7MN8O9z0GEFoPHoW-163&quot; value=&quot;&amp;lt;div style=&amp;quot;&amp;quot;&amp;gt;Image Feature List[3]&amp;lt;/div&amp;gt;&quot; style=&quot;rounded=0;whiteSpace=wrap;html=1;align=center;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;-70&quot; y=&quot;1080&quot; width=&quot;660&quot; height=&quot;40&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;2WVR7MN8O9z0GEFoPHoW-192&quot; style=&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;&quot; parent=&quot;1&quot; source=&quot;2WVR7MN8O9z0GEFoPHoW-169&quot; target=&quot;2WVR7MN8O9z0GEFoPHoW-183&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;2WVR7MN8O9z0GEFoPHoW-169&quot; value=&quot;&amp;lt;div style=&amp;quot;&amp;quot;&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;Image Feature:&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;blockquote style=&amp;quot;margin: 0 0 0 40px; border: none; padding: 0px;&amp;quot;&amp;gt;&amp;lt;div style=&amp;quot;&amp;quot;&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;Tensor(batch, k, 80, 80)&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;/blockquote&amp;gt;&quot; style=&quot;rounded=0;whiteSpace=wrap;html=1;align=left;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;-70&quot; y=&quot;1525&quot; width=&quot;210&quot; height=&quot;120&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;2WVR7MN8O9z0GEFoPHoW-193&quot; style=&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;&quot; parent=&quot;1&quot; source=&quot;2WVR7MN8O9z0GEFoPHoW-170&quot; target=&quot;2WVR7MN8O9z0GEFoPHoW-183&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;2WVR7MN8O9z0GEFoPHoW-170&quot; value=&quot;&amp;lt;div style=&amp;quot;&amp;quot;&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;Image Feature:&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;blockquote style=&amp;quot;margin: 0 0 0 40px; border: none; padding: 0px;&amp;quot;&amp;gt;&amp;lt;div style=&amp;quot;&amp;quot;&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;Tensor(batch, k, 40, 40)&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;/blockquote&amp;gt;&quot; style=&quot;rounded=0;whiteSpace=wrap;html=1;align=left;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;155&quot; y=&quot;1525&quot; width=&quot;210&quot; height=&quot;120&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;2WVR7MN8O9z0GEFoPHoW-194&quot; style=&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;&quot; parent=&quot;1&quot; source=&quot;2WVR7MN8O9z0GEFoPHoW-171&quot; target=&quot;2WVR7MN8O9z0GEFoPHoW-183&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;2WVR7MN8O9z0GEFoPHoW-171&quot; value=&quot;&amp;lt;div style=&amp;quot;&amp;quot;&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;Image Feature:&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;blockquote style=&amp;quot;margin: 0 0 0 40px; border: none; padding: 0px;&amp;quot;&amp;gt;&amp;lt;div style=&amp;quot;&amp;quot;&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;Tensor(batch, k, 20, 20)&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;/blockquote&amp;gt;&quot; style=&quot;rounded=0;whiteSpace=wrap;html=1;align=left;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;380&quot; y=&quot;1525&quot; width=&quot;210&quot; height=&quot;120&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;TavXo0WUxr7w91VWTHu4-50&quot; style=&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;&quot; parent=&quot;1&quot; source=&quot;2WVR7MN8O9z0GEFoPHoW-183&quot; target=&quot;TavXo0WUxr7w91VWTHu4-9&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;TavXo0WUxr7w91VWTHu4-51&quot; style=&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;&quot; parent=&quot;1&quot; source=&quot;2WVR7MN8O9z0GEFoPHoW-183&quot; target=&quot;TavXo0WUxr7w91VWTHu4-12&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;TavXo0WUxr7w91VWTHu4-52&quot; style=&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;&quot; parent=&quot;1&quot; source=&quot;2WVR7MN8O9z0GEFoPHoW-183&quot; target=&quot;TavXo0WUxr7w91VWTHu4-6&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;2WVR7MN8O9z0GEFoPHoW-183&quot; value=&quot;Cat on dim[1]&quot; style=&quot;rounded=0;whiteSpace=wrap;html=1;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;-770&quot; y=&quot;1700&quot; width=&quot;1360&quot; height=&quot;60&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;2WVR7MN8O9z0GEFoPHoW-212&quot; style=&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;&quot; parent=&quot;1&quot; source=&quot;2WVR7MN8O9z0GEFoPHoW-198&quot; target=&quot;2WVR7MN8O9z0GEFoPHoW-10&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;Array as=&quot;points&quot;&gt;&#10;              &lt;mxPoint x=&quot;690&quot; y=&quot;1170&quot; /&gt;&#10;              &lt;mxPoint x=&quot;335&quot; y=&quot;1170&quot; /&gt;&#10;            &lt;/Array&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;2WVR7MN8O9z0GEFoPHoW-198&quot; value=&quot;&amp;lt;div&amp;gt;Text Features:&amp;lt;/div&amp;gt;&amp;lt;blockquote style=&amp;quot;margin: 0 0 0 40px; border: none; padding: 0px;&amp;quot;&amp;gt;&amp;lt;div style=&amp;quot;text-align: right;&amp;quot;&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;Tensor: (batch, k, 512)&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;/blockquote&amp;gt;&quot; style=&quot;rounded=0;whiteSpace=wrap;html=1;align=left;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;590&quot; y=&quot;360&quot; width=&quot;200&quot; height=&quot;120&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;2WVR7MN8O9z0GEFoPHoW-204&quot; value=&quot;此时：&amp;lt;blockquote style=&amp;quot;margin: 0 0 0 40px; border: none; padding: 0px;&amp;quot;&amp;gt;&amp;lt;div&amp;gt;1. 每条prompt的为(1, 512)的张量，&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;对应着512个特征维度的分量。&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;2. 每个特征图为(1, 512, w, h)的张量，特征图的每个pixel对应着一个512个维度的张量。&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;3. 二者相乘，即可得特征图每个点的Image-Text的相似度&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;4. k和b都是一个可学习的标量，cv4用三个不同的网络处理三个不同的维度，每个网络的k、b值不一样。cv4中一共3个k值和b值。&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;/blockquote&amp;gt;&quot; style=&quot;rounded=0;whiteSpace=wrap;html=1;align=left;dashed=1;dashPattern=8 8;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;460&quot; y=&quot;1270&quot; width=&quot;290&quot; height=&quot;170&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;TavXo0WUxr7w91VWTHu4-1&quot; value=&quot;注：&amp;lt;div&amp;gt;&amp;lt;blockquote style=&amp;quot;margin: 0 0 0 40px; border: none; padding: 0px;&amp;quot;&amp;gt;&amp;lt;div&amp;gt;1. 三个特征图的h和w并不固定为(80, 80)、(40, 40) ...，而是以固定的下采样倍数生成，例如输入图像的(h, w)=(32*k1, 32*k2)，则三个特征图尺寸分别为(k1*4, k2*4)、(k1*2, k2*2)、(k1, k2)&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;2. 方便起见，这里统一输入为(640, 640)&amp;lt;/div&amp;gt;&amp;lt;/blockquote&amp;gt;&amp;lt;/div&amp;gt;&quot; style=&quot;rounded=0;whiteSpace=wrap;html=1;align=left;dashed=1;dashPattern=8 8;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;-740&quot; y=&quot;345&quot; width=&quot;265&quot; height=&quot;150&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;TavXo0WUxr7w91VWTHu4-2&quot; style=&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;&quot; parent=&quot;1&quot; source=&quot;TavXo0WUxr7w91VWTHu4-3&quot; target=&quot;TavXo0WUxr7w91VWTHu4-18&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;TavXo0WUxr7w91VWTHu4-3&quot; value=&quot;&amp;lt;div style=&amp;quot;&amp;quot;&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;Image Feature:&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;blockquote style=&amp;quot;margin: 0 0 0 40px; border: none; padding: 0px;&amp;quot;&amp;gt;&amp;lt;div style=&amp;quot;&amp;quot;&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;Tensor(batch,&amp;amp;nbsp;&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;text-align: center;&amp;quot;&amp;gt;reg_max*4+k&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;, 20*20)&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;/blockquote&amp;gt;&quot; style=&quot;rounded=0;whiteSpace=wrap;html=1;align=left;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;-630&quot; y=&quot;2101.5&quot; width=&quot;320&quot; height=&quot;120&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;TavXo0WUxr7w91VWTHu4-4&quot; style=&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;&quot; parent=&quot;1&quot; source=&quot;TavXo0WUxr7w91VWTHu4-6&quot; target=&quot;TavXo0WUxr7w91VWTHu4-16&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;TavXo0WUxr7w91VWTHu4-5&quot; style=&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;&quot; parent=&quot;1&quot; source=&quot;TavXo0WUxr7w91VWTHu4-6&quot; target=&quot;TavXo0WUxr7w91VWTHu4-27&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;TavXo0WUxr7w91VWTHu4-6&quot; value=&quot;&amp;lt;div style=&amp;quot;&amp;quot;&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;Image Feature:&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;blockquote style=&amp;quot;margin: 0 0 0 40px; border: none; padding: 0px;&amp;quot;&amp;gt;&amp;lt;div style=&amp;quot;&amp;quot;&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;Tensor(batch,&amp;amp;nbsp;&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;text-align: center;&amp;quot;&amp;gt;reg_max*4+k&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;, 80, 80)&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;/blockquote&amp;gt;&quot; style=&quot;rounded=0;whiteSpace=wrap;html=1;align=left;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;-640&quot; y=&quot;1800.5&quot; width=&quot;320&quot; height=&quot;120&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;TavXo0WUxr7w91VWTHu4-7&quot; style=&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;&quot; parent=&quot;1&quot; source=&quot;TavXo0WUxr7w91VWTHu4-9&quot; target=&quot;TavXo0WUxr7w91VWTHu4-16&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;TavXo0WUxr7w91VWTHu4-8&quot; style=&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;&quot; parent=&quot;1&quot; source=&quot;TavXo0WUxr7w91VWTHu4-9&quot; target=&quot;TavXo0WUxr7w91VWTHu4-27&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;245&quot; y=&quot;1981.5&quot; as=&quot;targetPoint&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;TavXo0WUxr7w91VWTHu4-9&quot; value=&quot;&amp;lt;div style=&amp;quot;&amp;quot;&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;Image Feature:&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;blockquote style=&amp;quot;margin: 0 0 0 40px; border: none; padding: 0px;&amp;quot;&amp;gt;&amp;lt;div style=&amp;quot;&amp;quot;&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;Tensor(batch,&amp;amp;nbsp;&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;text-align: center;&amp;quot;&amp;gt;reg_max*4+k&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;, 40, 40)&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;/blockquote&amp;gt;&quot; style=&quot;rounded=0;whiteSpace=wrap;html=1;align=left;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;-250&quot; y=&quot;1800.5&quot; width=&quot;320&quot; height=&quot;120&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;TavXo0WUxr7w91VWTHu4-10&quot; style=&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;&quot; parent=&quot;1&quot; source=&quot;TavXo0WUxr7w91VWTHu4-12&quot; target=&quot;TavXo0WUxr7w91VWTHu4-16&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;TavXo0WUxr7w91VWTHu4-11&quot; style=&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;&quot; parent=&quot;1&quot; source=&quot;TavXo0WUxr7w91VWTHu4-12&quot; target=&quot;TavXo0WUxr7w91VWTHu4-27&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;TavXo0WUxr7w91VWTHu4-12&quot; value=&quot;&amp;lt;div style=&amp;quot;&amp;quot;&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;Image Feature:&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;blockquote style=&amp;quot;margin: 0 0 0 40px; border: none; padding: 0px;&amp;quot;&amp;gt;&amp;lt;div style=&amp;quot;&amp;quot;&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;Tensor(batch,&amp;amp;nbsp;&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;text-align: center;&amp;quot;&amp;gt;reg_max*4+k&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;, 20, 20)&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;/blockquote&amp;gt;&quot; style=&quot;rounded=0;whiteSpace=wrap;html=1;align=left;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;140&quot; y=&quot;1800.5&quot; width=&quot;320&quot; height=&quot;120&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;TavXo0WUxr7w91VWTHu4-13&quot; style=&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;&quot; parent=&quot;1&quot; source=&quot;TavXo0WUxr7w91VWTHu4-16&quot; target=&quot;TavXo0WUxr7w91VWTHu4-24&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;TavXo0WUxr7w91VWTHu4-14&quot; style=&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;&quot; parent=&quot;1&quot; source=&quot;TavXo0WUxr7w91VWTHu4-16&quot; target=&quot;TavXo0WUxr7w91VWTHu4-20&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;TavXo0WUxr7w91VWTHu4-15&quot; style=&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;&quot; parent=&quot;1&quot; source=&quot;TavXo0WUxr7w91VWTHu4-16&quot; target=&quot;TavXo0WUxr7w91VWTHu4-3&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;TavXo0WUxr7w91VWTHu4-16&quot; value=&quot;view to [batch, regmax*4+k, w*h]&quot; style=&quot;rounded=0;whiteSpace=wrap;html=1;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;-706.25&quot; y=&quot;1981.5&quot; width=&quot;452.5&quot; height=&quot;60&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;TavXo0WUxr7w91VWTHu4-17&quot; style=&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;&quot; parent=&quot;1&quot; source=&quot;TavXo0WUxr7w91VWTHu4-18&quot; target=&quot;TavXo0WUxr7w91VWTHu4-22&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;TavXo0WUxr7w91VWTHu4-18&quot; value=&quot;torch.cat(dim=2)&quot; style=&quot;rounded=0;whiteSpace=wrap;html=1;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;-706.25&quot; y=&quot;2261.5&quot; width=&quot;452.5&quot; height=&quot;60&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;TavXo0WUxr7w91VWTHu4-19&quot; style=&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;&quot; parent=&quot;1&quot; source=&quot;TavXo0WUxr7w91VWTHu4-20&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;-480.1439393939394&quot; y=&quot;2261.5&quot; as=&quot;targetPoint&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;TavXo0WUxr7w91VWTHu4-20&quot; value=&quot;&amp;lt;div style=&amp;quot;&amp;quot;&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;Image Feature:&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;blockquote style=&amp;quot;margin: 0 0 0 40px; border: none; padding: 0px;&amp;quot;&amp;gt;&amp;lt;div style=&amp;quot;&amp;quot;&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;Tensor(batch,&amp;amp;nbsp;&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;text-align: center;&amp;quot;&amp;gt;reg_max*4+k&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;, 40*40)&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;/blockquote&amp;gt;&quot; style=&quot;rounded=0;whiteSpace=wrap;html=1;align=left;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;-640&quot; y=&quot;2091.5&quot; width=&quot;320&quot; height=&quot;120&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;TavXo0WUxr7w91VWTHu4-21&quot; style=&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;&quot; parent=&quot;1&quot; source=&quot;TavXo0WUxr7w91VWTHu4-22&quot; target=&quot;TavXo0WUxr7w91VWTHu4-32&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;TavXo0WUxr7w91VWTHu4-22&quot; value=&quot;&amp;lt;div style=&amp;quot;&amp;quot;&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;Image Feature:&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;blockquote style=&amp;quot;margin: 0 0 0 40px; border: none; padding: 0px;&amp;quot;&amp;gt;&amp;lt;div style=&amp;quot;&amp;quot;&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;Tensor(batch,&amp;amp;nbsp;&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;text-align: center;&amp;quot;&amp;gt;reg_max*4+k&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;, 6400+1600+400)&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;/blockquote&amp;gt;&quot; style=&quot;rounded=0;whiteSpace=wrap;html=1;align=left;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;-650&quot; y=&quot;2351.5&quot; width=&quot;340&quot; height=&quot;120&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;TavXo0WUxr7w91VWTHu4-23&quot; style=&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;&quot; parent=&quot;1&quot; source=&quot;TavXo0WUxr7w91VWTHu4-24&quot; target=&quot;TavXo0WUxr7w91VWTHu4-18&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;TavXo0WUxr7w91VWTHu4-24&quot; value=&quot;&amp;lt;div style=&amp;quot;&amp;quot;&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;Image Feature:&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;blockquote style=&amp;quot;margin: 0 0 0 40px; border: none; padding: 0px;&amp;quot;&amp;gt;&amp;lt;div style=&amp;quot;&amp;quot;&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;Tensor(batch,&amp;amp;nbsp;&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;text-align: center;&amp;quot;&amp;gt;reg_max*4+k&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;, 80*80)&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;/blockquote&amp;gt;&quot; style=&quot;rounded=0;whiteSpace=wrap;html=1;align=left;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;-650&quot; y=&quot;2081.5&quot; width=&quot;320&quot; height=&quot;120&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;TavXo0WUxr7w91VWTHu4-25&quot; style=&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;&quot; parent=&quot;1&quot; source=&quot;TavXo0WUxr7w91VWTHu4-27&quot; target=&quot;TavXo0WUxr7w91VWTHu4-38&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;TavXo0WUxr7w91VWTHu4-26&quot; style=&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;&quot; parent=&quot;1&quot; source=&quot;TavXo0WUxr7w91VWTHu4-27&quot; target=&quot;TavXo0WUxr7w91VWTHu4-40&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;TavXo0WUxr7w91VWTHu4-27&quot; value=&quot;计算各个特征图的anchor point和stride倍数：&amp;lt;blockquote style=&amp;quot;margin: 0 0 0 40px; border: none; padding: 0px;&amp;quot;&amp;gt;&amp;lt;div&amp;gt;anchor的取值为特征图的grid cell的中心点，例如：&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;amp;nbsp; &amp;amp;nbsp; anchor[0]=&amp;lt;/div&amp;gt;&amp;lt;/blockquote&amp;gt;&amp;lt;blockquote style=&amp;quot;margin: 0 0 0 40px; border: none; padding: 0px;&amp;quot;&amp;gt;&amp;lt;blockquote style=&amp;quot;margin: 0 0 0 40px; border: none; padding: 0px;&amp;quot;&amp;gt;[&amp;lt;/blockquote&amp;gt;&amp;lt;blockquote style=&amp;quot;margin: 0 0 0 40px; border: none; padding: 0px;&amp;quot;&amp;gt;&amp;amp;nbsp; &amp;amp;nbsp; [0.5, 0.5], [1.5, 0.5], [2.5, 0.5], ..., [79.5, 0.5],&amp;lt;/blockquote&amp;gt;&amp;lt;blockquote style=&amp;quot;margin: 0 0 0 40px; border: none; padding: 0px;&amp;quot;&amp;gt;&amp;amp;nbsp; &amp;amp;nbsp; [0.5,&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;&amp;amp;nbsp;1.5], [1.5, 1.5], [2.5, 1.5], ..., [79.5, 1.5],&amp;lt;/span&amp;gt;&amp;lt;/blockquote&amp;gt;&amp;lt;blockquote style=&amp;quot;margin: 0 0 0 40px; border: none; padding: 0px;&amp;quot;&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;&amp;amp;nbsp; &amp;amp;nbsp; ...&amp;lt;/span&amp;gt;&amp;lt;/blockquote&amp;gt;&amp;lt;blockquote style=&amp;quot;margin: 0 0 0 40px; border: none; padding: 0px;&amp;quot;&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;], shape=[6400, 2]&amp;lt;/span&amp;gt;&amp;lt;/blockquote&amp;gt;&amp;lt;/blockquote&amp;gt;&amp;lt;blockquote style=&amp;quot;margin: 0 0 0 40px; border: none; padding: 0px;&amp;quot;&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;&amp;amp;nbsp; &amp;amp;nbsp; anchor[1]=[ ... ], shape=[1600, 2]&amp;lt;/span&amp;gt;&amp;lt;/blockquote&amp;gt;&amp;lt;blockquote style=&amp;quot;margin: 0 0 0 40px; border: none; padding: 0px;&amp;quot;&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;&amp;amp;nbsp; &amp;amp;nbsp; anchor[2]=[ ... ], shape=[400, 2]&amp;lt;/span&amp;gt;&amp;lt;/blockquote&amp;gt;&amp;lt;blockquote style=&amp;quot;margin: 0 0 0 40px; border: none; padding: 0px;&amp;quot;&amp;gt;&amp;lt;blockquote style=&amp;quot;margin: 0 0 0 40px; border: none; padding: 0px;&amp;quot;&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/span&amp;gt;&amp;lt;/blockquote&amp;gt;&amp;lt;/blockquote&amp;gt;&amp;lt;blockquote style=&amp;quot;margin: 0 0 0 40px; border: none; padding: 0px;&amp;quot;&amp;gt;&amp;lt;div&amp;gt;stride倍数为各特征图相较于输入图像的下采样倍数，例如：&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;amp;nbsp; &amp;amp;nbsp; stride[0]=&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;[ 8.0, 8.0, 8.0, ..., 8.0],&amp;amp;nbsp;&amp;lt;/span&amp;gt;shape&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;=[6400, 1]&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;&amp;amp;nbsp; &amp;amp;nbsp; stride[1]=[ 16.0, 16.0, ..., 16.0], shape=[1600, 1]&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;&amp;amp;nbsp; &amp;amp;nbsp; stride[2]=[ 32.0, 32.0, ..., 32.0], shape=[400, 1]&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;随后将三组anchor、stride拼接转换为：&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;amp;nbsp; &amp;amp;nbsp; anchor.shape=[2, 8400]&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;amp;nbsp; &amp;amp;nbsp; stride.shape=[1, 8400]&amp;lt;/div&amp;gt;&amp;lt;/blockquote&amp;gt;&quot; style=&quot;rounded=0;whiteSpace=wrap;html=1;align=left;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;7.5&quot; y=&quot;1991.5&quot; width=&quot;452.5&quot; height=&quot;320&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;TavXo0WUxr7w91VWTHu4-28&quot; style=&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;&quot; parent=&quot;1&quot; source=&quot;TavXo0WUxr7w91VWTHu4-29&quot; target=&quot;TavXo0WUxr7w91VWTHu4-36&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;Array as=&quot;points&quot;&gt;&#10;              &lt;mxPoint x=&quot;-634&quot; y=&quot;2821.5&quot; /&gt;&#10;              &lt;mxPoint x=&quot;-320&quot; y=&quot;2821.5&quot; /&gt;&#10;            &lt;/Array&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;TavXo0WUxr7w91VWTHu4-29&quot; value=&quot;&amp;lt;div style=&amp;quot;&amp;quot;&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;boxes:&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;blockquote style=&amp;quot;margin: 0 0 0 40px; border: none; padding: 0px;&amp;quot;&amp;gt;&amp;lt;div style=&amp;quot;&amp;quot;&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;Tensor(batch,&amp;amp;nbsp;&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;text-align: center;&amp;quot;&amp;gt;reg_max*4&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;, 6400+1600+400)&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;/blockquote&amp;gt;&quot; style=&quot;rounded=0;whiteSpace=wrap;html=1;align=left;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;-780&quot; y=&quot;2611.5&quot; width=&quot;292.5&quot; height=&quot;120&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;TavXo0WUxr7w91VWTHu4-30&quot; style=&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;&quot; parent=&quot;1&quot; source=&quot;TavXo0WUxr7w91VWTHu4-32&quot; target=&quot;TavXo0WUxr7w91VWTHu4-29&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;TavXo0WUxr7w91VWTHu4-31&quot; style=&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;&quot; parent=&quot;1&quot; source=&quot;TavXo0WUxr7w91VWTHu4-32&quot; target=&quot;TavXo0WUxr7w91VWTHu4-34&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;TavXo0WUxr7w91VWTHu4-32&quot; value=&quot;slice&quot; style=&quot;rounded=0;whiteSpace=wrap;html=1;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;-650&quot; y=&quot;2501.5&quot; width=&quot;340&quot; height=&quot;60&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;TavXo0WUxr7w91VWTHu4-33&quot; style=&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;&quot; parent=&quot;1&quot; source=&quot;TavXo0WUxr7w91VWTHu4-34&quot; target=&quot;TavXo0WUxr7w91VWTHu4-42&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;Array as=&quot;points&quot;&gt;&#10;              &lt;mxPoint x=&quot;-320&quot; y=&quot;2781.5&quot; /&gt;&#10;              &lt;mxPoint x=&quot;150&quot; y=&quot;2781.5&quot; /&gt;&#10;            &lt;/Array&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;TavXo0WUxr7w91VWTHu4-34&quot; value=&quot;&amp;lt;div style=&amp;quot;&amp;quot;&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;cls:&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;blockquote style=&amp;quot;margin: 0 0 0 40px; border: none; padding: 0px;&amp;quot;&amp;gt;&amp;lt;div style=&amp;quot;text-align: center;&amp;quot;&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;Tensor(batch, k&amp;lt;/span&amp;gt;&amp;lt;span style=&amp;quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&amp;quot;&amp;gt;, 6400+1600+400)&amp;lt;/span&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;/blockquote&amp;gt;&quot; style=&quot;rounded=0;whiteSpace=wrap;html=1;align=left;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;-466.25&quot; y=&quot;2611.5&quot; width=&quot;292.5&quot; height=&quot;120&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;TavXo0WUxr7w91VWTHu4-35&quot; style=&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;&quot; parent=&quot;1&quot; source=&quot;TavXo0WUxr7w91VWTHu4-36&quot; target=&quot;TavXo0WUxr7w91VWTHu4-49&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;TavXo0WUxr7w91VWTHu4-36&quot; value=&quot;decode_bboxes&quot; style=&quot;rounded=0;whiteSpace=wrap;html=1;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;-466.25&quot; y=&quot;2891.5&quot; width=&quot;292.5&quot; height=&quot;60&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;TavXo0WUxr7w91VWTHu4-37&quot; style=&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;&quot; parent=&quot;1&quot; source=&quot;TavXo0WUxr7w91VWTHu4-38&quot; target=&quot;TavXo0WUxr7w91VWTHu4-36&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;Array as=&quot;points&quot;&gt;&#10;              &lt;mxPoint x=&quot;100&quot; y=&quot;2821.5&quot; /&gt;&#10;              &lt;mxPoint x=&quot;-320&quot; y=&quot;2821.5&quot; /&gt;&#10;            &lt;/Array&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;TavXo0WUxr7w91VWTHu4-38&quot; value=&quot;&amp;lt;div style=&amp;quot;&amp;quot;&amp;gt;anchor: Tensor(2, 8400)&amp;lt;/div&amp;gt;&quot; style=&quot;rounded=0;whiteSpace=wrap;html=1;align=center;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;-25&quot; y=&quot;2371.5&quot; width=&quot;250&quot; height=&quot;120&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;TavXo0WUxr7w91VWTHu4-39&quot; style=&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;&quot; parent=&quot;1&quot; source=&quot;TavXo0WUxr7w91VWTHu4-40&quot; target=&quot;TavXo0WUxr7w91VWTHu4-49&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;Array as=&quot;points&quot;&gt;&#10;              &lt;mxPoint x=&quot;380&quot; y=&quot;2731.5&quot; /&gt;&#10;              &lt;mxPoint x=&quot;-95&quot; y=&quot;2731.5&quot; /&gt;&#10;              &lt;mxPoint x=&quot;-95&quot; y=&quot;2971.5&quot; /&gt;&#10;              &lt;mxPoint x=&quot;-320&quot; y=&quot;2971.5&quot; /&gt;&#10;            &lt;/Array&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;TavXo0WUxr7w91VWTHu4-40&quot; value=&quot;&amp;lt;div style=&amp;quot;&amp;quot;&amp;gt;stride: Tensor(1, 8400)&amp;lt;/div&amp;gt;&quot; style=&quot;rounded=0;whiteSpace=wrap;html=1;align=center;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;255&quot; y=&quot;2371.5&quot; width=&quot;250&quot; height=&quot;120&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;TavXo0WUxr7w91VWTHu4-41&quot; style=&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.75;entryY=0;entryDx=0;entryDy=0;&quot; parent=&quot;1&quot; source=&quot;TavXo0WUxr7w91VWTHu4-42&quot; target=&quot;TavXo0WUxr7w91VWTHu4-45&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;TavXo0WUxr7w91VWTHu4-42&quot; value=&quot;sigmoid&quot; style=&quot;rounded=0;whiteSpace=wrap;html=1;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;3.75&quot; y=&quot;2891.5&quot; width=&quot;292.5&quot; height=&quot;60&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;TavXo0WUxr7w91VWTHu4-43&quot; style=&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.25;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;&quot; parent=&quot;1&quot; source=&quot;TavXo0WUxr7w91VWTHu4-45&quot; target=&quot;TavXo0WUxr7w91VWTHu4-46&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;TavXo0WUxr7w91VWTHu4-44&quot; style=&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.75;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;&quot; parent=&quot;1&quot; source=&quot;TavXo0WUxr7w91VWTHu4-45&quot; target=&quot;TavXo0WUxr7w91VWTHu4-47&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;TavXo0WUxr7w91VWTHu4-45&quot; value=&quot;nms&quot; style=&quot;rounded=0;whiteSpace=wrap;html=1;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;-466.25&quot; y=&quot;3081.5&quot; width=&quot;761.25&quot; height=&quot;60&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;TavXo0WUxr7w91VWTHu4-46&quot; value=&quot;bounding box&quot; style=&quot;rounded=0;whiteSpace=wrap;html=1;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;-466.25&quot; y=&quot;3201.5&quot; width=&quot;292.5&quot; height=&quot;60&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;TavXo0WUxr7w91VWTHu4-47&quot; value=&quot;prob[cls_id]&quot; style=&quot;rounded=0;whiteSpace=wrap;html=1;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;5&quot; y=&quot;3201.5&quot; width=&quot;292.5&quot; height=&quot;60&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;TavXo0WUxr7w91VWTHu4-48&quot; style=&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.25;entryY=0;entryDx=0;entryDy=0;&quot; parent=&quot;1&quot; source=&quot;TavXo0WUxr7w91VWTHu4-49&quot; target=&quot;TavXo0WUxr7w91VWTHu4-45&quot; edge=&quot;1&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;Array as=&quot;points&quot;&gt;&#10;              &lt;mxPoint x=&quot;-320&quot; y=&quot;3061.5&quot; /&gt;&#10;              &lt;mxPoint x=&quot;-276&quot; y=&quot;3061.5&quot; /&gt;&#10;            &lt;/Array&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;TavXo0WUxr7w91VWTHu4-49&quot; value=&quot;boxes *= stride&quot; style=&quot;rounded=0;whiteSpace=wrap;html=1;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;-466.25&quot; y=&quot;2991.5&quot; width=&quot;292.5&quot; height=&quot;60&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;TavXo0WUxr7w91VWTHu4-53&quot; value=&quot;注：后续处理和YOLO v8一致。&quot; style=&quot;rounded=0;whiteSpace=wrap;html=1;align=left;dashed=1;dashPattern=8 8;&quot; parent=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry x=&quot;-827&quot; y=&quot;1780&quot; width=&quot;180&quot; height=&quot;49.5&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;      &lt;/root&gt;&#10;    &lt;/mxGraphModel&gt;&#10;  &lt;/diagram&gt;&#10;&lt;/mxfile&gt;&#10;"><defs/><g><g data-cell-id="0"><g data-cell-id="1"><g data-cell-id="2WVR7MN8O9z0GEFoPHoW-150"><g><rect x="927" y="1150" width="340" height="150" fill="#ffffff" stroke="#000000" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 338px; height: 1px; padding-top: 1225px; margin-left: 929px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">cv4: BnContrastiveHead：<blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><div>x = x.norm</div></blockquote><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><div>对w的最后一个维度进行单位化</div><div>逐元素执行：x[b, k, h, w] = x[b, c, h, w] * w[b, k, c]</div><div>x = x * e^{k} + b</div><div>return x</div></blockquote></div></div></div></foreignObject><text x="929" y="1229" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px">cv4: BnContrastiveHead：...</text></switch></g></g></g><g data-cell-id="2WVR7MN8O9z0GEFoPHoW-151"><g><rect x="927" y="1120" width="170" height="30" fill="#ffffff" stroke="#000000" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 168px; height: 1px; padding-top: 1135px; margin-left: 928px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">x: Image Feat</div></div></div></foreignObject><text x="1012" y="1139" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">x: Image Feat</text></switch></g></g></g><g data-cell-id="2WVR7MN8O9z0GEFoPHoW-152"><g><rect x="1097" y="1120" width="170" height="30" fill="#ffffff" stroke="#000000" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 168px; height: 1px; padding-top: 1135px; margin-left: 1098px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">w: Text Feat</div></div></div></foreignObject><text x="1182" y="1139" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">w: Text Feat</text></switch></g></g></g><g data-cell-id="2WVR7MN8O9z0GEFoPHoW-202"><g><path d="M 1097 1360 L 1096.97 1382.48 L 1312 1382.48 L 1312 1398.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 1312 1403.88 L 1308.5 1396.88 L 1312 1398.63 L 1315.5 1396.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="2WVR7MN8O9z0GEFoPHoW-153"><g><rect x="927" y="1300" width="340" height="60" fill="#ffffff" stroke="#000000" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 338px; height: 1px; padding-top: 1330px; margin-left: 929px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><div style=""><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">Return: Similiarity Score</span></div><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><div>Tensor: (batch, k, 20, 20)</div></blockquote></div></div></div></foreignObject><text x="929" y="1334" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px">Return: Similiarity Score...</text></switch></g></g></g><g data-cell-id="2WVR7MN8O9z0GEFoPHoW-93"><g><rect x="237" y="1210" width="320" height="80" fill="#ffffff" stroke="#000000" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 318px; height: 1px; padding-top: 1250px; margin-left: 239px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">cv2: Conv+SiLU：<blockquote style="margin: 0px 0px 0px 40px; border: none; padding: 0px;">两次Conv(3, 3)+SiLU</blockquote><blockquote style="margin: 0px 0px 0px 40px; border: none; padding: 0px;">一次Conv(1, 1)</blockquote><blockquote style="margin: 0px 0px 0px 40px; border: none; padding: 0px;">最终输出宽高与输入相同，输出channel=<span style="text-align: center; background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">reg_max*4</span></blockquote></div></div></div></foreignObject><text x="239" y="1254" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px">cv2: Conv+SiLU：...</text></switch></g></g></g><g data-cell-id="2WVR7MN8O9z0GEFoPHoW-94"><g><rect x="237" y="1180" width="320" height="30" fill="#ffffff" stroke="#000000" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 318px; height: 1px; padding-top: 1195px; margin-left: 238px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">x: Image Feature</div></div></div></foreignObject><text x="397" y="1199" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">x: Image Feature</text></switch></g></g></g><g data-cell-id="2WVR7MN8O9z0GEFoPHoW-115"><g><path d="M 397 1330 L 397.03 1367.52 L 612 1367.52 L 612 1398.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 612 1403.88 L 608.5 1396.88 L 612 1398.63 L 615.5 1396.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="2WVR7MN8O9z0GEFoPHoW-95"><g><rect x="237" y="1290" width="320" height="40" fill="#ffffff" stroke="#000000" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 318px; height: 1px; padding-top: 1310px; margin-left: 238px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">Return: (batch, 64, 20, 20)</div></div></div></foreignObject><text x="397" y="1314" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">Return: (batch, 64, 20, 20)</text></switch></g></g></g><g data-cell-id="TavXo0WUxr7w91VWTHu4-55"><g><path d="M 1517 100 L 1517 233.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 1517 238.88 L 1513.5 231.88 L 1517 233.63 L 1520.5 231.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="2WVR7MN8O9z0GEFoPHoW-2"><g><rect x="1417" y="0" width="200" height="100" fill="#ffffff" stroke="#000000" stroke-dasharray="3 3" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 198px; height: 1px; padding-top: 50px; margin-left: 1418px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">texts:<div>prompt 1</div><div>prompt 2</div><div>...</div><div>prompt k</div></div></div></div></foreignObject><text x="1517" y="54" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">texts:...</text></switch></g></g></g><g data-cell-id="2WVR7MN8O9z0GEFoPHoW-5"><g><path d="M 0 400 L 1657 400" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="2WVR7MN8O9z0GEFoPHoW-6"><g><rect x="0" y="400" width="60" height="30" fill="none" stroke="none" pointer-events="all"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 58px; height: 1px; padding-top: 415px; margin-left: 1px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">Head</div></div></div></foreignObject><text x="30" y="419" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">Head</text></switch></g></g></g><g data-cell-id="2WVR7MN8O9z0GEFoPHoW-110"><g><path d="M 492 360 L 492 400 L 732 400 L 732 433.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 732 438.88 L 728.5 431.88 L 732 433.63 L 735.5 431.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="2WVR7MN8O9z0GEFoPHoW-20"><g><rect x="387" y="240" width="210" height="120" fill="#ffffff" stroke="#000000" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 208px; height: 1px; padding-top: 300px; margin-left: 389px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><div style=""><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">Image Feature:</span></div><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><div style=""><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">Tensor(batch, 192, 80, 80)</span></div></blockquote></div></div></div></foreignObject><text x="389" y="304" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px">Image Feature:...</text></switch></g></g></g><g data-cell-id="2WVR7MN8O9z0GEFoPHoW-111"><g><path d="M 732 360 L 732 400 L 731.91 433.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 731.89 438.88 L 728.41 431.87 L 731.91 433.63 L 735.41 431.89 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="2WVR7MN8O9z0GEFoPHoW-21"><g><rect x="627" y="240" width="210" height="120" fill="#ffffff" stroke="#000000" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 208px; height: 1px; padding-top: 300px; margin-left: 629px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><div style=""><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">Image Feature:</span></div><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><div style=""><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">Tensor(batch, 384, 40, 40)</span></div></blockquote></div></div></div></foreignObject><text x="629" y="304" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px">Image Feature:...</text></switch></g></g></g><g data-cell-id="2WVR7MN8O9z0GEFoPHoW-112"><g><path d="M 972 360 L 972 400 L 732 400 L 732 433.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 732 438.88 L 728.5 431.88 L 732 433.63 L 735.5 431.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="2WVR7MN8O9z0GEFoPHoW-22"><g><rect x="867" y="240" width="210" height="120" fill="#ffffff" stroke="#000000" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 208px; height: 1px; padding-top: 300px; margin-left: 869px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><div style=""><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">Image Feature:</span></div><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><div style=""><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">Tensor(batch, 576, 20, 20)</span></div></blockquote></div></div></div></foreignObject><text x="869" y="304" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px">Image Feature:...</text></switch></g></g></g><g data-cell-id="2WVR7MN8O9z0GEFoPHoW-59"><g><rect x="227" y="1200" width="320" height="80" fill="#ffffff" stroke="#000000" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 318px; height: 1px; padding-top: 1240px; margin-left: 229px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">cv2: Conv+SiLU：<blockquote style="margin: 0px 0px 0px 40px; border: none; padding: 0px;">两次Conv(3, 3)+SiLU</blockquote><blockquote style="margin: 0px 0px 0px 40px; border: none; padding: 0px;">一次Conv(1, 1)</blockquote><blockquote style="margin: 0px 0px 0px 40px; border: none; padding: 0px;">最终输出宽高与输入相同，输出channel=<span style="text-align: center; background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">reg_max*4</span></blockquote></div></div></div></foreignObject><text x="229" y="1244" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px">cv2: Conv+SiLU：...</text></switch></g></g></g><g data-cell-id="2WVR7MN8O9z0GEFoPHoW-60"><g><rect x="227" y="1170" width="320" height="30" fill="#ffffff" stroke="#000000" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 318px; height: 1px; padding-top: 1185px; margin-left: 228px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">x: Image Feature</div></div></div></foreignObject><text x="387" y="1189" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">x: Image Feature</text></switch></g></g></g><g data-cell-id="2WVR7MN8O9z0GEFoPHoW-114"><g><path d="M 387 1320 L 387 1398.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 387 1403.88 L 383.5 1396.88 L 387 1398.63 L 390.5 1396.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="2WVR7MN8O9z0GEFoPHoW-62"><g><rect x="227" y="1280" width="320" height="40" fill="#ffffff" stroke="#000000" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 318px; height: 1px; padding-top: 1300px; margin-left: 228px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">Return: (batch, 64, 40, 40)</div></div></div></foreignObject><text x="387" y="1304" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">Return: (batch, 64, 40, 40)</text></switch></g></g></g><g data-cell-id="2WVR7MN8O9z0GEFoPHoW-63"><g><rect x="217" y="1190" width="320" height="80" fill="#ffffff" stroke="#000000" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 318px; height: 1px; padding-top: 1230px; margin-left: 219px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">cv2: Conv+SiLU：<blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;">两次Conv(3, 3)+SiLU</blockquote><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;">一次Conv(1, 1)</blockquote><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;">最终输出宽高与输入相同，输出channel=<span style="text-align: center; background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">reg_max*4</span></blockquote></div></div></div></foreignObject><text x="219" y="1234" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px">cv2: Conv+SiLU：...</text></switch></g></g></g><g data-cell-id="2WVR7MN8O9z0GEFoPHoW-64"><g><rect x="217" y="1160" width="320" height="30" fill="#ffffff" stroke="#000000" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 318px; height: 1px; padding-top: 1175px; margin-left: 218px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">x: Image Feature</div></div></div></foreignObject><text x="377" y="1179" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">x: Image Feature</text></switch></g></g></g><g data-cell-id="2WVR7MN8O9z0GEFoPHoW-113"><g><path d="M 377 1310 L 377.03 1357.52 L 162 1357.52 L 162 1398.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 162 1403.88 L 158.5 1396.88 L 162 1398.63 L 165.5 1396.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="2WVR7MN8O9z0GEFoPHoW-66"><g><rect x="217" y="1270" width="320" height="40" fill="#ffffff" stroke="#000000" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 318px; height: 1px; padding-top: 1290px; margin-left: 218px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">Return: (batch, reg_max*4, 80, 80)</div></div></div></foreignObject><text x="377" y="1294" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">Return: (batch, reg_max*4, 80, 80)</text></switch></g></g></g><g data-cell-id="2WVR7MN8O9z0GEFoPHoW-189"><g><path d="M 162 1525 L 162 1552.48 L 736.97 1552.48 L 736.97 1573.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 736.97 1578.88 L 733.47 1571.88 L 736.97 1573.63 L 740.47 1571.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="2WVR7MN8O9z0GEFoPHoW-71"><g><rect x="57" y="1405" width="210" height="120" fill="#ffffff" stroke="#000000" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 208px; height: 1px; padding-top: 1465px; margin-left: 59px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><div style=""><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">Image Feature:</span></div><div style=""><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">    Tensor(batch, </span><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); text-align: center;">reg_max*4</span><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">, 80, 80)</span></div></div></div></div></foreignObject><text x="59" y="1469" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px">Image Feature:...</text></switch></g></g></g><g data-cell-id="2WVR7MN8O9z0GEFoPHoW-190"><g><path d="M 387 1525 L 387.03 1552.48 L 737.52 1552.48 L 737.12 1573.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 737.02 1578.88 L 733.65 1571.82 L 737.12 1573.63 L 740.65 1571.95 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="2WVR7MN8O9z0GEFoPHoW-72"><g><rect x="282" y="1405" width="210" height="120" fill="#ffffff" stroke="#000000" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 208px; height: 1px; padding-top: 1465px; margin-left: 284px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><div style=""><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">Image Feature:</span></div><div style=""><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">    Tensor(batch, </span><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); text-align: center;">reg_max*4</span><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">, 40, 40)</span></div></div></div></div></foreignObject><text x="284" y="1469" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px">Image Feature:...</text></switch></g></g></g><g data-cell-id="2WVR7MN8O9z0GEFoPHoW-191"><g><path d="M 612 1525 L 612 1552.48 L 737.52 1552.48 L 737.12 1573.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 737.02 1578.88 L 733.65 1571.82 L 737.12 1573.63 L 740.65 1571.95 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="2WVR7MN8O9z0GEFoPHoW-73"><g><rect x="507" y="1405" width="210" height="120" fill="#ffffff" stroke="#000000" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 208px; height: 1px; padding-top: 1465px; margin-left: 509px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><div style=""><div><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">Image Feature:</span></div><div><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">    Tensor(batch, </span><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); text-align: center;">reg_max*4</span><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">, 20, 20)</span></div></div></div></div></div></foreignObject><text x="509" y="1469" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px">Image Feature:...</text></switch></g></g></g><g data-cell-id="2WVR7MN8O9z0GEFoPHoW-77"><g><rect x="937" y="605" width="320" height="80" fill="#ffffff" stroke="#000000" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 318px; height: 1px; padding-top: 645px; margin-left: 939px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">cv3: Conv+SiLU：<blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;">第一次Conv(3, 3)+SiLU降维到192</blockquote><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;">第二次Conv(3, 3)+SiLU维度不变(192)</blockquote><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;">最后Conv(1, 1)升维到512</blockquote><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;">最终输出宽高与输入相同，输出channel=512</blockquote></div></div></div></foreignObject><text x="939" y="649" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px">cv3: Conv+SiLU：...</text></switch></g></g></g><g data-cell-id="2WVR7MN8O9z0GEFoPHoW-78"><g><rect x="937" y="575" width="320" height="30" fill="#ffffff" stroke="#000000" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 318px; height: 1px; padding-top: 590px; margin-left: 938px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">x: Image Feature</div></div></div></foreignObject><text x="1097" y="594" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">x: Image Feature</text></switch></g></g></g><g data-cell-id="2WVR7MN8O9z0GEFoPHoW-124"><g><path d="M 1097 725 L 1096.97 762.48 L 1312 762.48 L 1312 793.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 1312 798.88 L 1308.5 791.88 L 1312 793.63 L 1315.5 791.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="2WVR7MN8O9z0GEFoPHoW-79"><g><rect x="937" y="685" width="320" height="40" fill="#ffffff" stroke="#000000" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 318px; height: 1px; padding-top: 705px; margin-left: 938px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">Return: (batch, 512, 40, 40)</div></div></div></foreignObject><text x="1097" y="709" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">Return: (batch, 512, 40, 40)</text></switch></g></g></g><g data-cell-id="2WVR7MN8O9z0GEFoPHoW-74"><g><rect x="927" y="595" width="320" height="80" fill="#ffffff" stroke="#000000" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 318px; height: 1px; padding-top: 635px; margin-left: 929px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">cv3: Conv+SiLU：<blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;">第一次Conv(3, 3)+SiLU降维到192</blockquote><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;">第二次Conv(3, 3)+SiLU维度不变(192)</blockquote><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;">最后Conv(1, 1)升维到512</blockquote><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;">最终输出宽高与输入相同，输出channel=512</blockquote></div></div></div></foreignObject><text x="929" y="639" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px">cv3: Conv+SiLU：...</text></switch></g></g></g><g data-cell-id="2WVR7MN8O9z0GEFoPHoW-75"><g><rect x="927" y="565" width="320" height="30" fill="#ffffff" stroke="#000000" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 318px; height: 1px; padding-top: 580px; margin-left: 928px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">x: Image Feature</div></div></div></foreignObject><text x="1087" y="584" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">x: Image Feature</text></switch></g></g></g><g data-cell-id="2WVR7MN8O9z0GEFoPHoW-123"><g><path d="M 1087 715 L 1087 793.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 1087 798.88 L 1083.5 791.88 L 1087 793.63 L 1090.5 791.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="2WVR7MN8O9z0GEFoPHoW-76"><g><rect x="927" y="675" width="320" height="40" fill="#ffffff" stroke="#000000" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 318px; height: 1px; padding-top: 695px; margin-left: 928px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">Return: (batch, 512, 40, 40)</div></div></div></foreignObject><text x="1087" y="699" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">Return: (batch, 512, 40, 40)</text></switch></g></g></g><g data-cell-id="2WVR7MN8O9z0GEFoPHoW-67"><g><rect x="917" y="585" width="320" height="80" fill="#ffffff" stroke="#000000" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 318px; height: 1px; padding-top: 625px; margin-left: 919px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">cv3: Conv+SiLU：<blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;">第一次Conv(3, 3)+SiLU降维到192</blockquote><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;">第二次Conv(3, 3)+SiLU维度不变(192)</blockquote><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;">最后Conv(1, 1)升维到512</blockquote><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;">最终输出宽高与输入相同，输出channel=512</blockquote></div></div></div></foreignObject><text x="919" y="629" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px">cv3: Conv+SiLU：...</text></switch></g></g></g><g data-cell-id="2WVR7MN8O9z0GEFoPHoW-68"><g><rect x="917" y="555" width="320" height="30" fill="#ffffff" stroke="#000000" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 318px; height: 1px; padding-top: 570px; margin-left: 918px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">x: Image Feature</div></div></div></foreignObject><text x="1077" y="574" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">x: Image Feature</text></switch></g></g></g><g data-cell-id="2WVR7MN8O9z0GEFoPHoW-122"><g><path d="M 1077 705 L 1076.97 752.48 L 862 752.48 L 862 793.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 862 798.88 L 858.5 791.88 L 862 793.63 L 865.5 791.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="2WVR7MN8O9z0GEFoPHoW-70"><g><rect x="917" y="665" width="320" height="40" fill="#ffffff" stroke="#000000" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 318px; height: 1px; padding-top: 685px; margin-left: 918px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">Return: (batch, 512, 80, 80)</div></div></div></foreignObject><text x="1077" y="689" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">Return: (batch, 512, 80, 80)</text></switch></g></g></g><g data-cell-id="2WVR7MN8O9z0GEFoPHoW-108"><g><path d="M 732 480 L 732 520 L 377.03 520 L 377 1153.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 377 1158.88 L 373.5 1151.88 L 377 1153.63 L 380.5 1151.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="2WVR7MN8O9z0GEFoPHoW-109"><g><path d="M 732 480 L 732 520 L 1076.97 520 L 1076.99 548.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 1077 553.88 L 1073.49 546.89 L 1076.99 548.63 L 1080.49 546.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="2WVR7MN8O9z0GEFoPHoW-103"><g><rect x="387" y="440" width="690" height="40" fill="#ffffff" stroke="#000000" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 688px; height: 1px; padding-top: 460px; margin-left: 388px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><div style="">Image Feature List[3]</div></div></div></div></foreignObject><text x="732" y="464" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">Image Feature List[3]</text></switch></g></g></g><g data-cell-id="2WVR7MN8O9z0GEFoPHoW-130"><g><path d="M 862 920 L 862 940 L 1087.52 940 L 1087.16 953.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 1087.03 958.88 L 1083.71 951.79 L 1087.16 953.63 L 1090.71 951.98 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="2WVR7MN8O9z0GEFoPHoW-119"><g><rect x="757" y="800" width="210" height="120" fill="#ffffff" stroke="#000000" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 208px; height: 1px; padding-top: 860px; margin-left: 759px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><div style=""><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">Image Feature:</span></div><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><div style=""><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">Tensor(batch, 512, 80, 80)</span></div></blockquote></div></div></div></foreignObject><text x="759" y="864" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px">Image Feature:...</text></switch></g></g></g><g data-cell-id="2WVR7MN8O9z0GEFoPHoW-131"><g><path d="M 1087 920 L 1086.97 940 L 1086.99 953.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 1087 958.88 L 1083.49 951.89 L 1086.99 953.63 L 1090.49 951.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="2WVR7MN8O9z0GEFoPHoW-120"><g><rect x="982" y="800" width="210" height="120" fill="#ffffff" stroke="#000000" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 208px; height: 1px; padding-top: 860px; margin-left: 984px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><div style=""><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">Image Feature:</span></div><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><div style=""><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">Tensor(batch, 512, 40, 40)</span></div></blockquote></div></div></div></foreignObject><text x="984" y="864" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px">Image Feature:...</text></switch></g></g></g><g data-cell-id="2WVR7MN8O9z0GEFoPHoW-132"><g><path d="M 1312 920 L 1312 940 L 1087.52 940 L 1087.16 953.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 1087.03 958.88 L 1083.71 951.79 L 1087.16 953.63 L 1090.71 951.98 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="2WVR7MN8O9z0GEFoPHoW-121"><g><rect x="1207" y="800" width="210" height="120" fill="#ffffff" stroke="#000000" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 208px; height: 1px; padding-top: 860px; margin-left: 1209px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><div style=""><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">Image Feature:</span></div><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><div style=""><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">Tensor(batch, 512, 20, 20)</span></div></blockquote></div></div></div></foreignObject><text x="1209" y="864" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px">Image Feature:...</text></switch></g></g></g><g data-cell-id="2WVR7MN8O9z0GEFoPHoW-145"><g><rect x="917" y="1140" width="340" height="150" fill="#ffffff" stroke="#000000" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 338px; height: 1px; padding-top: 1215px; margin-left: 919px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">cv4: BnContrastiveHead：<blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><div>x = x.norm</div></blockquote><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><div>对w的最后一个维度进行单位化</div><div>逐元素执行：x[b, k, h, w] = x[b, c, h, w] * w[b, k, c]</div><div>x = x * e^{k} + b</div><div>return x</div></blockquote></div></div></div></foreignObject><text x="919" y="1219" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px">cv4: BnContrastiveHead：...</text></switch></g></g></g><g data-cell-id="2WVR7MN8O9z0GEFoPHoW-146"><g><rect x="917" y="1110" width="170" height="30" fill="#ffffff" stroke="#000000" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 168px; height: 1px; padding-top: 1125px; margin-left: 918px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">x: Image Feat</div></div></div></foreignObject><text x="1002" y="1129" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">x: Image Feat</text></switch></g></g></g><g data-cell-id="2WVR7MN8O9z0GEFoPHoW-147"><g><rect x="1087" y="1110" width="170" height="30" fill="#ffffff" stroke="#000000" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 168px; height: 1px; padding-top: 1125px; margin-left: 1088px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">w: Text Feat</div></div></div></foreignObject><text x="1172" y="1129" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">w: Text Feat</text></switch></g></g></g><g data-cell-id="2WVR7MN8O9z0GEFoPHoW-201"><g><path d="M 1087 1350 L 1087 1398.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 1087 1403.88 L 1083.5 1396.88 L 1087 1398.63 L 1090.5 1396.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="2WVR7MN8O9z0GEFoPHoW-148"><g><rect x="917" y="1290" width="340" height="60" fill="#ffffff" stroke="#000000" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 338px; height: 1px; padding-top: 1320px; margin-left: 919px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><div style=""><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">Return: Similiarity Score</span></div><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><div>Tensor: (batch, k, 40, 40)</div></blockquote></div></div></div></foreignObject><text x="919" y="1324" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px">Return: Similiarity Score...</text></switch></g></g></g><g data-cell-id="2WVR7MN8O9z0GEFoPHoW-7"><g><rect x="907" y="1130" width="340" height="150" fill="#ffffff" stroke="#000000" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 338px; height: 1px; padding-top: 1205px; margin-left: 909px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">cv4: BnContrastiveHead：<blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><div>x = x.norm</div></blockquote><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><div>对w的最后一个维度进行单位化</div><div>逐元素执行：x[b, k, h, w] = x[b, c, h, w] * w[b, k, c]</div><div>x = x * e^{k} + b</div><div>return x</div></blockquote></div></div></div></foreignObject><text x="909" y="1209" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px">cv4: BnContrastiveHead：...</text></switch></g></g></g><g data-cell-id="2WVR7MN8O9z0GEFoPHoW-9"><g><rect x="907" y="1100" width="170" height="30" fill="#ffffff" stroke="#000000" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 168px; height: 1px; padding-top: 1115px; margin-left: 908px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">x: Image Feat</div></div></div></foreignObject><text x="992" y="1119" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">x: Image Feat</text></switch></g></g></g><g data-cell-id="2WVR7MN8O9z0GEFoPHoW-10"><g><rect x="1077" y="1100" width="170" height="30" fill="#ffffff" stroke="#000000" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 168px; height: 1px; padding-top: 1115px; margin-left: 1078px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">w: Text Feat</div></div></div></foreignObject><text x="1162" y="1119" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">w: Text Feat</text></switch></g></g></g><g data-cell-id="2WVR7MN8O9z0GEFoPHoW-200"><g><path d="M 1077 1340 L 1076.97 1372.48 L 862 1372.48 L 862 1398.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 862 1403.88 L 858.5 1396.88 L 862 1398.63 L 865.5 1396.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="2WVR7MN8O9z0GEFoPHoW-12"><g><rect x="907" y="1280" width="340" height="60" fill="#ffffff" stroke="#000000" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 338px; height: 1px; padding-top: 1310px; margin-left: 909px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><div style=""><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">Return: Similiarity Score</span></div><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><div>Tensor: (batch, k, 80, 80)</div></blockquote></div></div></div></foreignObject><text x="909" y="1314" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px">Return: Similiarity Score...</text></switch></g></g></g><g data-cell-id="2WVR7MN8O9z0GEFoPHoW-168"><g><path d="M 1087 1000 L 1086.97 1050 L 992 1050 L 992 1093.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 992 1098.88 L 988.5 1091.88 L 992 1093.63 L 995.5 1091.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="2WVR7MN8O9z0GEFoPHoW-163"><g><rect x="757" y="960" width="660" height="40" fill="#ffffff" stroke="#000000" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 658px; height: 1px; padding-top: 980px; margin-left: 758px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><div style="">Image Feature List[3]</div></div></div></div></foreignObject><text x="1087" y="984" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">Image Feature List[3]</text></switch></g></g></g><g data-cell-id="2WVR7MN8O9z0GEFoPHoW-192"><g><path d="M 862 1525 L 862 1552.48 L 736.97 1552.48 L 736.99 1573.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 737 1578.88 L 733.49 1571.89 L 736.99 1573.63 L 740.49 1571.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="2WVR7MN8O9z0GEFoPHoW-169"><g><rect x="757" y="1405" width="210" height="120" fill="#ffffff" stroke="#000000" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 208px; height: 1px; padding-top: 1465px; margin-left: 759px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><div style=""><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">Image Feature:</span></div><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><div style=""><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">Tensor(batch, k, 80, 80)</span></div></blockquote></div></div></div></foreignObject><text x="759" y="1469" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px">Image Feature:...</text></switch></g></g></g><g data-cell-id="2WVR7MN8O9z0GEFoPHoW-193"><g><path d="M 1087 1525 L 1086.97 1552.48 L 736.97 1552.48 L 736.99 1573.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 737 1578.88 L 733.49 1571.89 L 736.99 1573.63 L 740.49 1571.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="2WVR7MN8O9z0GEFoPHoW-170"><g><rect x="982" y="1405" width="210" height="120" fill="#ffffff" stroke="#000000" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 208px; height: 1px; padding-top: 1465px; margin-left: 984px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><div style=""><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">Image Feature:</span></div><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><div style=""><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">Tensor(batch, k, 40, 40)</span></div></blockquote></div></div></div></foreignObject><text x="984" y="1469" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px">Image Feature:...</text></switch></g></g></g><g data-cell-id="2WVR7MN8O9z0GEFoPHoW-194"><g><path d="M 1312 1525 L 1312 1552.48 L 736.97 1552.48 L 736.99 1573.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 737 1578.88 L 733.49 1571.89 L 736.99 1573.63 L 740.49 1571.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="2WVR7MN8O9z0GEFoPHoW-171"><g><rect x="1207" y="1405" width="210" height="120" fill="#ffffff" stroke="#000000" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 208px; height: 1px; padding-top: 1465px; margin-left: 1209px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><div style=""><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">Image Feature:</span></div><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><div style=""><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">Tensor(batch, k, 20, 20)</span></div></blockquote></div></div></div></foreignObject><text x="1209" y="1469" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px">Image Feature:...</text></switch></g></g></g><g data-cell-id="TavXo0WUxr7w91VWTHu4-50"><g><path d="M 737 1640 L 737 1674.13" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 737 1679.38 L 733.5 1672.38 L 737 1674.13 L 740.5 1672.38 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="TavXo0WUxr7w91VWTHu4-51"><g><path d="M 737 1640 L 736.97 1660.28 L 1126.97 1660.28 L 1126.99 1674.13" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 1127 1679.38 L 1123.49 1672.39 L 1126.99 1674.13 L 1130.49 1672.38 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="TavXo0WUxr7w91VWTHu4-52"><g><path d="M 737 1640 L 736.97 1660.28 L 347.03 1660.28 L 347.01 1674.13" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 347 1679.38 L 343.51 1672.38 L 347.01 1674.13 L 350.51 1672.39 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="2WVR7MN8O9z0GEFoPHoW-183"><g><rect x="57" y="1580" width="1360" height="60" fill="#ffffff" stroke="#000000" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1358px; height: 1px; padding-top: 1610px; margin-left: 58px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">Cat on dim[1]</div></div></div></foreignObject><text x="737" y="1614" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">Cat on dim[1]</text></switch></g></g></g><g data-cell-id="2WVR7MN8O9z0GEFoPHoW-212"><g><path d="M 1517 360 L 1517.03 1050 L 1162 1050 L 1162 1093.63" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 1162 1098.88 L 1158.5 1091.88 L 1162 1093.63 L 1165.5 1091.88 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="2WVR7MN8O9z0GEFoPHoW-198"><g><rect x="1417" y="240" width="200" height="120" fill="#ffffff" stroke="#000000" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 198px; height: 1px; padding-top: 300px; margin-left: 1419px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><div>Text Features:</div><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><div style="text-align: right;"><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">Tensor: (batch, k, 512)</span></div></blockquote></div></div></div></foreignObject><text x="1419" y="304" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px">Text Features:...</text></switch></g></g></g><g data-cell-id="2WVR7MN8O9z0GEFoPHoW-204"><g><rect x="1287" y="1150" width="290" height="170" fill="#ffffff" stroke="#000000" stroke-dasharray="8 8" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 288px; height: 1px; padding-top: 1235px; margin-left: 1289px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">此时：<blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><div>1. 每条prompt的为(1, 512)的张量，<span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">对应着512个特征维度的分量。</span></div><div><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">2. 每个特征图为(1, 512, w, h)的张量，特征图的每个pixel对应着一个512个维度的张量。</span></div><div><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">3. 二者相乘，即可得特征图每个点的Image-Text的相似度</span></div><div><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">4. k和b都是一个可学习的标量，cv4用三个不同的网络处理三个不同的维度，每个网络的k、b值不一样。cv4中一共3个k值和b值。</span></div></blockquote></div></div></div></foreignObject><text x="1289" y="1239" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px">此时：1. 每条prompt的为(1, 512)的张量，对应着512个特征维度的分量。...</text></switch></g></g></g><g data-cell-id="TavXo0WUxr7w91VWTHu4-1"><g><rect x="87" y="225" width="265" height="150" fill="#ffffff" stroke="#000000" stroke-dasharray="8 8" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 263px; height: 1px; padding-top: 300px; margin-left: 89px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">注：<div><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><div>1. 三个特征图的h和w并不固定为(80, 80)、(40, 40) ...，而是以固定的下采样倍数生成，例如输入图像的(h, w)=(32*k1, 32*k2)，则三个特征图尺寸分别为(k1*4, k2*4)、(k1*2, k2*2)、(k1, k2)</div><div>2. 方便起见，这里统一输入为(640, 640)</div></blockquote></div></div></div></div></foreignObject><text x="89" y="304" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px">注：1. 三个特征图的h和w并不固定为(80, 80)、(40, 40) ...，而是以固定的下采样倍数生成，例如输入图像的(h, w)=(32*k1, 32*k...</text></switch></g></g></g><g data-cell-id="TavXo0WUxr7w91VWTHu4-2"><g><path d="M 357 2101.5 L 357.03 2121.52 L 347.03 2121.52 L 347.01 2135.13" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 347 2140.38 L 343.51 2133.38 L 347.01 2135.13 L 350.51 2133.39 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="TavXo0WUxr7w91VWTHu4-3"><g><rect x="197" y="1981.5" width="320" height="120" fill="#ffffff" stroke="#000000" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 318px; height: 1px; padding-top: 2042px; margin-left: 199px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><div style=""><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">Image Feature:</span></div><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><div style=""><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">Tensor(batch, </span><span style="text-align: center;">reg_max*4+k</span><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">, 20*20)</span></div></blockquote></div></div></div></foreignObject><text x="199" y="2045" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px">Image Feature:...</text></switch></g></g></g><g data-cell-id="TavXo0WUxr7w91VWTHu4-4"><g><path d="M 347 1800.5 L 347 1855.13" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 347 1860.38 L 343.5 1853.38 L 347 1855.13 L 350.5 1853.38 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="TavXo0WUxr7w91VWTHu4-5"><g><path d="M 347 1800.5 L 347.03 1836 L 1060.76 1836 L 1060.76 1865.13" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 1060.76 1870.38 L 1057.26 1863.38 L 1060.76 1865.13 L 1064.26 1863.38 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="TavXo0WUxr7w91VWTHu4-6"><g><rect x="187" y="1680.5" width="320" height="120" fill="#ffffff" stroke="#000000" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 318px; height: 1px; padding-top: 1741px; margin-left: 189px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><div style=""><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">Image Feature:</span></div><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><div style=""><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">Tensor(batch, </span><span style="text-align: center;">reg_max*4+k</span><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">, 80, 80)</span></div></blockquote></div></div></div></foreignObject><text x="189" y="1744" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px">Image Feature:...</text></switch></g></g></g><g data-cell-id="TavXo0WUxr7w91VWTHu4-7"><g><path d="M 737 1800.5 L 736.97 1831.03 L 347.03 1831.03 L 347.01 1855.13" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 347 1860.38 L 343.51 1853.38 L 347.01 1855.13 L 350.51 1853.39 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="TavXo0WUxr7w91VWTHu4-8"><g><path d="M 737 1800.5 L 736.97 1836 L 1060.69 1836 L 1060.74 1865.13" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 1060.75 1870.38 L 1057.24 1863.39 L 1060.74 1865.13 L 1064.24 1863.38 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="TavXo0WUxr7w91VWTHu4-9"><g><rect x="577" y="1680.5" width="320" height="120" fill="#ffffff" stroke="#000000" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 318px; height: 1px; padding-top: 1741px; margin-left: 579px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><div style=""><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">Image Feature:</span></div><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><div style=""><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">Tensor(batch, </span><span style="text-align: center;">reg_max*4+k</span><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">, 40, 40)</span></div></blockquote></div></div></div></foreignObject><text x="579" y="1744" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px">Image Feature:...</text></switch></g></g></g><g data-cell-id="TavXo0WUxr7w91VWTHu4-10"><g><path d="M 1127 1800.5 L 1126.97 1831.03 L 347.03 1831.03 L 347.01 1855.13" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 347 1860.38 L 343.51 1853.38 L 347.01 1855.13 L 350.51 1853.39 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="TavXo0WUxr7w91VWTHu4-11"><g><path d="M 1127 1800.5 L 1126.97 1836 L 1060.69 1836 L 1060.74 1865.13" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 1060.75 1870.38 L 1057.24 1863.39 L 1060.74 1865.13 L 1064.24 1863.38 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="TavXo0WUxr7w91VWTHu4-12"><g><rect x="967" y="1680.5" width="320" height="120" fill="#ffffff" stroke="#000000" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 318px; height: 1px; padding-top: 1741px; margin-left: 969px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><div style=""><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">Image Feature:</span></div><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><div style=""><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">Tensor(batch, </span><span style="text-align: center;">reg_max*4+k</span><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">, 20, 20)</span></div></blockquote></div></div></div></foreignObject><text x="969" y="1744" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px">Image Feature:...</text></switch></g></g></g><g data-cell-id="TavXo0WUxr7w91VWTHu4-13"><g><path d="M 347 1921.5 L 347.03 1941.52 L 337.03 1941.52 L 337.01 1955.13" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 337 1960.38 L 333.51 1953.38 L 337.01 1955.13 L 340.51 1953.39 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="TavXo0WUxr7w91VWTHu4-14"><g><path d="M 347 1921.5 L 347 1965.13" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 347 1970.38 L 343.5 1963.38 L 347 1965.13 L 350.5 1963.38 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="TavXo0WUxr7w91VWTHu4-15"><g><path d="M 347 1921.5 L 347.03 1951.52 L 357.03 1951.52 L 357.01 1975.13" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 357 1980.38 L 353.51 1973.38 L 357.01 1975.13 L 360.51 1973.39 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="TavXo0WUxr7w91VWTHu4-16"><g><rect x="120.75" y="1861.5" width="452.5" height="60" fill="#ffffff" stroke="#000000" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 451px; height: 1px; padding-top: 1892px; margin-left: 122px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">view to [batch, regmax*4+k, w*h]</div></div></div></foreignObject><text x="347" y="1895" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">view to [batch, regmax*4+k, w*h]</text></switch></g></g></g><g data-cell-id="TavXo0WUxr7w91VWTHu4-17"><g><path d="M 347 2201.5 L 347 2225.13" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 347 2230.38 L 343.5 2223.38 L 347 2225.13 L 350.5 2223.38 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="TavXo0WUxr7w91VWTHu4-18"><g><rect x="120.75" y="2141.5" width="452.5" height="60" fill="#ffffff" stroke="#000000" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 451px; height: 1px; padding-top: 2172px; margin-left: 122px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">torch.cat(dim=2)</div></div></div></foreignObject><text x="347" y="2175" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">torch.cat(dim=2)</text></switch></g></g></g><g data-cell-id="TavXo0WUxr7w91VWTHu4-19"><g><path d="M 347 2091.5 L 347.03 2116.48 L 346.9 2135.13" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 346.86 2140.38 L 343.41 2133.36 L 346.9 2135.13 L 350.41 2133.41 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="TavXo0WUxr7w91VWTHu4-20"><g><rect x="187" y="1971.5" width="320" height="120" fill="#ffffff" stroke="#000000" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 318px; height: 1px; padding-top: 2032px; margin-left: 189px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><div style=""><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">Image Feature:</span></div><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><div style=""><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">Tensor(batch, </span><span style="text-align: center;">reg_max*4+k</span><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">, 40*40)</span></div></blockquote></div></div></div></foreignObject><text x="189" y="2035" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px">Image Feature:...</text></switch></g></g></g><g data-cell-id="TavXo0WUxr7w91VWTHu4-21"><g><path d="M 347 2351.5 L 347 2375.13" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 347 2380.38 L 343.5 2373.38 L 347 2375.13 L 350.5 2373.38 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="TavXo0WUxr7w91VWTHu4-22"><g><rect x="177" y="2231.5" width="340" height="120" fill="#ffffff" stroke="#000000" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 338px; height: 1px; padding-top: 2292px; margin-left: 179px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><div style=""><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">Image Feature:</span></div><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><div style=""><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">Tensor(batch, </span><span style="text-align: center;">reg_max*4+k</span><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">, 6400+1600+400)</span></div></blockquote></div></div></div></foreignObject><text x="179" y="2295" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px">Image Feature:...</text></switch></g></g></g><g data-cell-id="TavXo0WUxr7w91VWTHu4-23"><g><path d="M 337 2081.5 L 337.03 2111.52 L 347.03 2111.52 L 347.01 2135.13" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 347 2140.38 L 343.51 2133.38 L 347.01 2135.13 L 350.51 2133.39 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="TavXo0WUxr7w91VWTHu4-24"><g><rect x="177" y="1961.5" width="320" height="120" fill="#ffffff" stroke="#000000" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 318px; height: 1px; padding-top: 2022px; margin-left: 179px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><div style=""><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">Image Feature:</span></div><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><div style=""><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">Tensor(batch, </span><span style="text-align: center;">reg_max*4+k</span><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">, 80*80)</span></div></blockquote></div></div></div></foreignObject><text x="179" y="2025" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px">Image Feature:...</text></switch></g></g></g><g data-cell-id="TavXo0WUxr7w91VWTHu4-25"><g><path d="M 1060.75 2191.5 L 1060.69 2221.52 L 926.97 2221.52 L 926.99 2245.13" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 927 2250.38 L 923.49 2243.39 L 926.99 2245.13 L 930.49 2243.38 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="TavXo0WUxr7w91VWTHu4-26"><g><path d="M 1060.75 2191.5 L 1060.69 2221.52 L 1206.97 2221.52 L 1206.99 2245.13" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 1207 2250.38 L 1203.49 2243.39 L 1206.99 2245.13 L 1210.49 2243.38 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="TavXo0WUxr7w91VWTHu4-27"><g><rect x="834.5" y="1871.5" width="452.5" height="320" fill="#ffffff" stroke="#000000" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 451px; height: 1px; padding-top: 2032px; margin-left: 837px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">计算各个特征图的anchor point和stride倍数：<blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><div>anchor的取值为特征图的grid cell的中心点，例如：</div><div>    anchor[0]=</div></blockquote><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;">[</blockquote><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;">    [0.5, 0.5], [1.5, 0.5], [2.5, 0.5], ..., [79.5, 0.5],</blockquote><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;">    [0.5,<span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"> 1.5], [1.5, 1.5], [2.5, 1.5], ..., [79.5, 1.5],</span></blockquote><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">    ...</span></blockquote><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">], shape=[6400, 2]</span></blockquote></blockquote><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">    anchor[1]=[ ... ], shape=[1600, 2]</span></blockquote><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">    anchor[2]=[ ... ], shape=[400, 2]</span></blockquote><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"><br /></span></blockquote></blockquote><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><div>stride倍数为各特征图相较于输入图像的下采样倍数，例如：</div><div>    stride[0]=<span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">[ 8.0, 8.0, 8.0, ..., 8.0], </span>shape<span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">=[6400, 1]</span></div><div><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">    stride[1]=[ 16.0, 16.0, ..., 16.0], shape=[1600, 1]</span></div><div><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">    stride[2]=[ 32.0, 32.0, ..., 32.0], shape=[400, 1]</span></div><div><br /></div><div>随后将三组anchor、stride拼接转换为：</div><div>    anchor.shape=[2, 8400]</div><div>    stride.shape=[1, 8400]</div></blockquote></div></div></div></foreignObject><text x="837" y="2035" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px">计算各个特征图的anchor point和stride倍数：...</text></switch></g></g></g><g data-cell-id="TavXo0WUxr7w91VWTHu4-28"><g><path d="M 193.25 2611.5 L 193.31 2701.52 L 507.03 2701.52 L 507 2765.13" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 507 2770.38 L 503.5 2763.38 L 507 2765.13 L 510.5 2763.38 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="TavXo0WUxr7w91VWTHu4-29"><g><rect x="47" y="2491.5" width="292.5" height="120" fill="#ffffff" stroke="#000000" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 291px; height: 1px; padding-top: 2552px; margin-left: 49px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><div style=""><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">boxes:</span></div><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><div style=""><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">Tensor(batch, </span><span style="text-align: center;">reg_max*4</span><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">, 6400+1600+400)</span></div></blockquote></div></div></div></foreignObject><text x="49" y="2555" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px">boxes:...</text></switch></g></g></g><g data-cell-id="TavXo0WUxr7w91VWTHu4-30"><g><path d="M 347 2441.5 L 347.03 2466.48 L 193.31 2466.48 L 193.27 2485.13" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 193.25 2490.38 L 189.77 2483.37 L 193.27 2485.13 L 196.77 2483.39 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="TavXo0WUxr7w91VWTHu4-31"><g><path d="M 347 2441.5 L 347.03 2466.48 L 507.03 2466.48 L 507.01 2485.13" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 507 2490.38 L 503.51 2483.38 L 507.01 2485.13 L 510.51 2483.39 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="TavXo0WUxr7w91VWTHu4-32"><g><rect x="177" y="2381.5" width="340" height="60" fill="#ffffff" stroke="#000000" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 338px; height: 1px; padding-top: 2412px; margin-left: 178px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">slice</div></div></div></foreignObject><text x="347" y="2415" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">slice</text></switch></g></g></g><g data-cell-id="TavXo0WUxr7w91VWTHu4-33"><g><path d="M 507 2611.5 L 507.03 2661.52 L 976.97 2661.52 L 977 2765.13" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 977 2770.38 L 973.5 2763.38 L 977 2765.13 L 980.5 2763.38 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="TavXo0WUxr7w91VWTHu4-34"><g><rect x="360.75" y="2491.5" width="292.5" height="120" fill="#ffffff" stroke="#000000" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 291px; height: 1px; padding-top: 2552px; margin-left: 363px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><div style=""><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">cls:</span></div><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><div style="text-align: center;"><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">Tensor(batch, k</span><span style="background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));">, 6400+1600+400)</span></div></blockquote></div></div></div></foreignObject><text x="363" y="2555" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px">cls:...</text></switch></g></g></g><g data-cell-id="TavXo0WUxr7w91VWTHu4-35"><g><path d="M 507 2831.5 L 507 2865.13" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 507 2870.38 L 503.5 2863.38 L 507 2865.13 L 510.5 2863.38 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="TavXo0WUxr7w91VWTHu4-36"><g><rect x="360.75" y="2771.5" width="292.5" height="60" fill="#ffffff" stroke="#000000" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 291px; height: 1px; padding-top: 2802px; margin-left: 362px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">decode_bboxes</div></div></div></foreignObject><text x="507" y="2805" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">decode_bboxes</text></switch></g></g></g><g data-cell-id="TavXo0WUxr7w91VWTHu4-37"><g><path d="M 927 2371.5 L 926.97 2701.52 L 507.03 2701.52 L 507 2765.13" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 507 2770.38 L 503.5 2763.38 L 507 2765.13 L 510.5 2763.38 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="TavXo0WUxr7w91VWTHu4-38"><g><rect x="802" y="2251.5" width="250" height="120" fill="#ffffff" stroke="#000000" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 248px; height: 1px; padding-top: 2312px; margin-left: 803px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><div style="">anchor: Tensor(2, 8400)</div></div></div></div></foreignObject><text x="927" y="2315" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">anchor: Tensor(2, 8400)</text></switch></g></g></g><g data-cell-id="TavXo0WUxr7w91VWTHu4-39"><g><path d="M 1207 2371.5 L 1206.97 2611.52 L 732 2611.52 L 732 2851.52 L 507.03 2851.52 L 507.01 2865.13" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 507 2870.38 L 503.51 2863.38 L 507.01 2865.13 L 510.51 2863.39 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="TavXo0WUxr7w91VWTHu4-40"><g><rect x="1082" y="2251.5" width="250" height="120" fill="#ffffff" stroke="#000000" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 248px; height: 1px; padding-top: 2312px; margin-left: 1083px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><div style="">stride: Tensor(1, 8400)</div></div></div></div></foreignObject><text x="1207" y="2315" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">stride: Tensor(1, 8400)</text></switch></g></g></g><g data-cell-id="TavXo0WUxr7w91VWTHu4-41"><g><path d="M 977 2831.5 L 976.97 2896.48 L 931.72 2896.48 L 931.69 2955.13" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 931.69 2960.38 L 928.19 2953.38 L 931.69 2955.13 L 935.19 2953.38 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="TavXo0WUxr7w91VWTHu4-42"><g><rect x="830.75" y="2771.5" width="292.5" height="60" fill="#ffffff" stroke="#000000" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 291px; height: 1px; padding-top: 2802px; margin-left: 832px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">sigmoid</div></div></div></foreignObject><text x="977" y="2805" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">sigmoid</text></switch></g></g></g><g data-cell-id="TavXo0WUxr7w91VWTHu4-43"><g><path d="M 551.06 3021.5 L 551.1 3051.52 L 507.03 3051.52 L 507.01 3075.13" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 507 3080.38 L 503.51 3073.38 L 507.01 3075.13 L 510.51 3073.39 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="TavXo0WUxr7w91VWTHu4-44"><g><path d="M 931.69 3021.5 L 931.72 3051.52 L 978.21 3051.52 L 978.24 3075.13" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 978.25 3080.38 L 974.74 3073.39 L 978.24 3075.13 L 981.74 3073.38 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="TavXo0WUxr7w91VWTHu4-45"><g><rect x="360.75" y="2961.5" width="761.25" height="60" fill="#ffffff" stroke="#000000" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 759px; height: 1px; padding-top: 2992px; margin-left: 362px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">nms</div></div></div></foreignObject><text x="741" y="2995" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">nms</text></switch></g></g></g><g data-cell-id="TavXo0WUxr7w91VWTHu4-46"><g><rect x="360.75" y="3081.5" width="292.5" height="60" fill="#ffffff" stroke="#000000" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 291px; height: 1px; padding-top: 3112px; margin-left: 362px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">bounding box</div></div></div></foreignObject><text x="507" y="3115" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">bounding box</text></switch></g></g></g><g data-cell-id="TavXo0WUxr7w91VWTHu4-47"><g><rect x="832" y="3081.5" width="292.5" height="60" fill="#ffffff" stroke="#000000" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 291px; height: 1px; padding-top: 3112px; margin-left: 833px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">prob[cls_id]</div></div></div></foreignObject><text x="978" y="3115" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">prob[cls_id]</text></switch></g></g></g><g data-cell-id="TavXo0WUxr7w91VWTHu4-48"><g><path d="M 507 2931.5 L 507.03 2941.52 L 551.1 2941.52 L 551.08 2955.13" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 551.06 2960.38 L 547.58 2953.37 L 551.08 2955.13 L 554.58 2953.39 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="TavXo0WUxr7w91VWTHu4-49"><g><rect x="360.75" y="2871.5" width="292.5" height="60" fill="#ffffff" stroke="#000000" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 291px; height: 1px; padding-top: 2902px; margin-left: 362px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">boxes *= stride</div></div></div></foreignObject><text x="507" y="2905" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px" text-anchor="middle">boxes *= stride</text></switch></g></g></g><g data-cell-id="TavXo0WUxr7w91VWTHu4-53"><g><rect x="0" y="1660" width="180" height="49.5" fill="#ffffff" stroke="#000000" stroke-dasharray="8 8" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 178px; height: 1px; padding-top: 1685px; margin-left: 2px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: &quot;Helvetica&quot;; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">注：后续处理和YOLO v8一致。</div></div></div></foreignObject><text x="2" y="1688" fill="light-dark(#000000, #ffffff)" font-family="&quot;Helvetica&quot;" font-size="12px">注：后续处理和YOLO v8一致。</text></switch></g></g></g></g></g></g><switch><g requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"/><a transform="translate(0,-5)" xlink:href="https://www.drawio.com/doc/faq/svg-export-text-problems" target="_blank"><text text-anchor="middle" font-size="10px" x="50%" y="100%">Text is not SVG - cannot display</text></a></switch></svg>